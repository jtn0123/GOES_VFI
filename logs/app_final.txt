[37m[I] root: Log level set to DEBUG[0m
[36m[D] __main__: Debug mode enabled via --debug flag.[0m
[36m[D] __main__: QSettings will be stored at: /Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist[0m
[36m[D] __main__: Entering MainWindow.__init__... debug_mode=True[0m
[36m[D] __main__: Settings will be stored at: /Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist[0m
[37m[I] __main__: Models instantiated.[0m
[37m[I] goesvfi.view_models.main_window_view_model: MainWindowViewModel initializing...[0m
[37m[I] goesvfi.view_models.main_window_view_model: FileSorterViewModel instantiated.[0m
[37m[I] goesvfi.view_models.main_window_view_model: DateSorterViewModel instantiated.[0m
[37m[I] goesvfi.view_models.processing_view_model: ProcessingViewModel initialized[0m
[37m[I] goesvfi.view_models.main_window_view_model: ProcessingViewModel instantiated.[0m
[37m[I] goesvfi.view_models.main_window_view_model: MainWindowViewModel initialized.[0m
[37m[I] __main__: ViewModels instantiated.[0m
[37m[I] __main__: GUI Image processors instantiated.[0m
[36m[D] goesvfi.utils.gui_helpers: Entering ClickableLabel.__init__...[0m
[36m[D] goesvfi.utils.gui_helpers: Entering ClickableLabel.__init__...[0m
[36m[D] goesvfi.utils.gui_helpers: Entering ClickableLabel.__init__...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button created and connected[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting MainTab signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting IO control signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting preview control signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting crop control signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting processing setting signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Connecting RIFE option signals...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button already connected in _setup_ui[0m
[36m[D] goesvfi.gui_tabs.main_tab: Verifying processing signal connections...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Verifying processing signal connections...[0m
[36m[D] goesvfi.gui_tabs.main_tab: MainWindow has _handle_processing method: True[0m
[36m[D] goesvfi.gui_tabs.main_tab: MainWindow appears to have necessary handler methods[0m
[36m[D] goesvfi.gui_tabs.main_tab: Ensuring processing_started signal is connected...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Processing signal connection verified/created[0m
[36m[D] goesvfi.gui_tabs.main_tab: All MainTab signals connected.[0m
[36m[D] goesvfi.gui_tabs.main_tab: MainTab: Performing post-init setup...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Populating RIFE models...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Loaded RIFE analysis cache from /Users/justin/Documents/goesvfi/cache/rife_analysis_cache.json[0m
[36m[D] goesvfi.gui_tabs.main_tab: Using cached analysis for rife-v4.6 (rife-cli)[0m
[37m[I] goesvfi.gui_tabs.main_tab: RIFE model selected: rife-v4.6[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: has_paths=False, in_dir=None, out_file=None[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: RIFE selected, model_ok=True[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button should be enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Restored last selected RIFE model: rife-v4.6[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: has_paths=False, in_dir=None, out_file=None[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: RIFE selected, model_ok=True[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button should be enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: has_paths=False, in_dir=None, out_file=None[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button check: RIFE selected, model_ok=True[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button should be enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Start button enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: _update_crop_buttons_state: Checking conditions - has_in_dir=False, has_crop=False[0m
[36m[D] goesvfi.gui_tabs.main_tab: MainTab: Post-init setup complete.[0m
[36m[D] goesvfi.gui_tabs.model_library_tab: Populating model table...[0m
[36m[D] goesvfi.gui_tabs.model_library_tab: Populated model table with 1 models.[0m
[37m[I] goesvfi.integrity_check.cache_db: Cache database initialized at /Users/justin/.goes_vfi/integrity_check/cache.db[0m
[37m[I] goesvfi.integrity_check.cache_db: Cache database initialized at /Users/justin/.goes_vfi/integrity_check/cache.db[0m
[36m[D] __main__: MainWindow loadSettings - QSettings details: org=GOES_VFI, app=GOES_VFI_App, file=/Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist[0m
[36m[D] __main__: MainWindow loadSettings - Available keys: ['cropRect', 'inputDir', 'main/lastTabIndex', 'paths/inputDirectory', 'preview/cropRectangle', 'processing/encoder', 'processing/fps', 'processing/maxWorkers', 'processing/multiplier', 'rife/modelKey', 'rife/threadSpec', 'rife/tileSize', 'rife/tilingEnabled', 'rife/ttaSpatial', 'rife/ttaTemporal', 'rife/uhdMode', 'sanchez/falseColorEnabled', 'sanchez/resolutionKm'][0m
[36m[D] __main__: Successfully set fps_spinbox value to 30[0m
[36m[D] __main__: Set multiplier_spinbox to 2 (loaded mid_count=1)[0m
[36m[D] __main__: Set encoder_combo to RIFE[0m
[33m[W] __main__: Key 'scd' in profile but not in current settings.[0m
[36m[D] root: Setting up preview update...[0m
[36m[D] root: request_previews_update connected to _update_previews[0m
[37m[I] __main__: MainWindow initialized.[0m
[36m[D] __main__: Entering _update_previews. Current crop_rect: None, Sanchez enabled: False[0m
[36m[D] __main__: Entering _update_previews method[0m
[36m[D] __main__: No valid input directory, clearing previews[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Directory browse requested in enhanced integrity check tab[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Opening directory dialog with starting directory: /Users/justin[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Selected directory: /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Setting base directory to: /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Directory browse completed successfully[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Attempting to auto-detect date range for GOES_18 in /Users/justin/Desktop/GOES-18[0m
[37m[I] goesvfi.integrity_check.time_index: Found 790 PNG files in /Users/justin/Desktop/GOES-18[0m
[37m[I] goesvfi.integrity_check.time_index: Found 35 timestamps in /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Auto-detect found dates: start=2024-12-21 15:30:22, end=2024-12-22 14:30:22[0m
[31m[E] goesvfi.integrity_check.enhanced_gui_tab: Error auto-detecting satellite type: name 'QProgressDialog' is not defined[0m
[31m[E] goesvfi.integrity_check.enhanced_gui_tab: Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/enhanced_gui_tab.py", line 1601, in _auto_detect_satellite
    progress_dialog = QProgressDialog("Scanning files...", "Cancel", 0, 100, self)
                      ^^^^^^^^^^^^^^^
NameError: name 'QProgressDialog' is not defined. Did you mean: 'QProgressBar'?
[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Attempting to auto-detect date range for GOES_18 in /Users/justin/Desktop/GOES-18[0m
[37m[I] goesvfi.integrity_check.time_index: Found 790 PNG files in /Users/justin/Desktop/GOES-18[0m
[37m[I] goesvfi.integrity_check.time_index: Found 35 timestamps in /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Auto-detect found dates: start=2024-12-21 15:30:22, end=2024-12-22 14:30:22[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Starting enhanced scan operation[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Scan date range: 2024-12-21T00:00:00 to 2024-12-22T23:59:00[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Scan parameters: interval=0min, force_rescan=False, auto_download=False[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Scan directory: /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Satellite: GOES_18, Fetch source: AUTO[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Calling start_enhanced_scan on view model[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Starting enhanced scan with parameters:[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model:   Base directory: /Users/justin/Desktop/GOES-18[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model:   Satellite: SatellitePattern.GOES_18[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model:   Date range: 2024-12-21 00:00:00 to 2024-12-22 23:59:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model:   Interval minutes: 0[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Starting scan...'[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Creating AsyncScanTask instance[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Starting AsyncScanTask in thread pool[0m
[37m[I] goesvfi.integrity_check.enhanced_view_model: Enhanced scan task started - waiting for progress updates[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Enhanced scan started successfully[0m
[36m[D] asyncio: Using selector: KqueueSelector[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Starting scan operation with params: dir=/Users/justin/Desktop/GOES-18, sat=GOES_18, start=2024-12-21 00:00:00, end=2024-12-22 23:59:00[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting scan step 1/5: Generating expected timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 0/5 - Step 1/5: Generating expected timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 0/5 - Step 1/5: Generating expected timestamps...[0m
[33m[W] goesvfi.integrity_check.reconcile_manager: Invalid interval minutes: 0, defaulting to 10[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Using interval of 10 minutes between timestamps[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting timestamp generation from 2024-12-21 00:00:00 to 2024-12-22 23:59:00[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Generated 288 expected timestamps from 2024-12-21 00:00:00 to 2024-12-22 23:59:00[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting scan step 2/5: Checking cache for 288 timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 1/5 - Step 2/5: Checking cache for 288 timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 1/5 - Step 2/5: Checking cache for 288 timestamps...[0m
[31m[E] goesvfi.integrity_check.cache_db: Error getting timestamps from cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting scan step 3/5: Found 0/288 in cache, preparing filesystem check...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 2/5 - Step 3/5: Found 0/288 in cache, preparing filesystem check...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 2/5 - Step 3/5: Found 0/288 in cache, preparing filesystem check...[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting scan step 4/5: Checking filesystem for 288 timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem for 288 timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem for 288 timestamps...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (1/288): 2024-12-21T00:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (1/288): 2024-12-21T00:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (11/288): 2024-12-21T01:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (11/288): 2024-12-21T01:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (21/288): 2024-12-21T03:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (21/288): 2024-12-21T03:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (31/288): 2024-12-21T05:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (31/288): 2024-12-21T05:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (41/288): 2024-12-21T06:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (41/288): 2024-12-21T06:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (51/288): 2024-12-21T08:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (51/288): 2024-12-21T08:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (61/288): 2024-12-21T10:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (61/288): 2024-12-21T10:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (71/288): 2024-12-21T11:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (71/288): 2024-12-21T11:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (81/288): 2024-12-21T13:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (81/288): 2024-12-21T13:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (91/288): 2024-12-21T15:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (91/288): 2024-12-21T15:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (101/288): 2024-12-21T16:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (101/288): 2024-12-21T16:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (111/288): 2024-12-21T18:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (111/288): 2024-12-21T18:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (121/288): 2024-12-21T20:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (121/288): 2024-12-21T20:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (131/288): 2024-12-21T21:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (131/288): 2024-12-21T21:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (141/288): 2024-12-21T23:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (141/288): 2024-12-21T23:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (151/288): 2024-12-22T01:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (151/288): 2024-12-22T01:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (161/288): 2024-12-22T02:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (161/288): 2024-12-22T02:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (171/288): 2024-12-22T04:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (171/288): 2024-12-22T04:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (181/288): 2024-12-22T06:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (181/288): 2024-12-22T06:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (191/288): 2024-12-22T07:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (191/288): 2024-12-22T07:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (201/288): 2024-12-22T09:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (201/288): 2024-12-22T09:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (211/288): 2024-12-22T11:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (211/288): 2024-12-22T11:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (221/288): 2024-12-22T12:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (221/288): 2024-12-22T12:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (231/288): 2024-12-22T14:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (231/288): 2024-12-22T14:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (241/288): 2024-12-22T16:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (241/288): 2024-12-22T16:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (251/288): 2024-12-22T17:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (251/288): 2024-12-22T17:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (261/288): 2024-12-22T19:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (261/288): 2024-12-22T19:20:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (271/288): 2024-12-22T21:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (271/288): 2024-12-22T21:00:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (281/288): 2024-12-22T22:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (281/288): 2024-12-22T22:40:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 3/5 - Step 4/5: Checking filesystem (288/288): 2024-12-22T23:50:00[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 3/5 - Step 4/5: Checking filesystem (288/288): 2024-12-22T23:50:00[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Starting scan step 5/5: Finalizing scan results...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 4/5 - Step 5/5: Finalizing scan results...[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 4/5 - Step 5/5: Finalizing scan results...[0m
[37m[I] goesvfi.integrity_check.reconcile_manager: Scan complete: 0/288 files found, 288 missing (checked 288 on filesystem)[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Scan completed successfully: 288 files missing out of 288[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Enhanced progress callback: step 5/5 - Scan complete: 288 files missing out of 288[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Progress callback: 5/5 - Scan complete: 288 files missing out of 288[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Scan completed with 0 existing files and 288 missing files[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 1/5: Generating expected timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 1/5:</span> Generating expected timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 2/5: Checking cache for 288 timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 2/5:</span> Checking cache for 288 timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 3/5: Found 0/288 in cache, preparing filesystem check...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 3/5:</span> Found 0/288 in cache, preparing filesystem check...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem for 288 timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem for 288 timestamps...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (1/288): 2024-12-21T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (1/288): 2024-12-21T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (11/288): 2024-12-21T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (11/288): 2024-12-21T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (21/288): 2024-12-21T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (21/288): 2024-12-21T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (31/288): 2024-12-21T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (31/288): 2024-12-21T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (41/288): 2024-12-21T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (41/288): 2024-12-21T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (51/288): 2024-12-21T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (51/288): 2024-12-21T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (61/288): 2024-12-21T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (61/288): 2024-12-21T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (71/288): 2024-12-21T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (71/288): 2024-12-21T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (81/288): 2024-12-21T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (81/288): 2024-12-21T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (91/288): 2024-12-21T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (91/288): 2024-12-21T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (101/288): 2024-12-21T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (101/288): 2024-12-21T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (111/288): 2024-12-21T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (111/288): 2024-12-21T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (121/288): 2024-12-21T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (121/288): 2024-12-21T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (131/288): 2024-12-21T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (131/288): 2024-12-21T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (141/288): 2024-12-21T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (141/288): 2024-12-21T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (151/288): 2024-12-22T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (151/288): 2024-12-22T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (161/288): 2024-12-22T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (161/288): 2024-12-22T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (171/288): 2024-12-22T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (171/288): 2024-12-22T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (181/288): 2024-12-22T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (181/288): 2024-12-22T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (191/288): 2024-12-22T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (191/288): 2024-12-22T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (201/288): 2024-12-22T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (201/288): 2024-12-22T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (211/288): 2024-12-22T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (211/288): 2024-12-22T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (221/288): 2024-12-22T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (221/288): 2024-12-22T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (231/288): 2024-12-22T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (231/288): 2024-12-22T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (241/288): 2024-12-22T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (241/288): 2024-12-22T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (251/288): 2024-12-22T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (251/288): 2024-12-22T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (261/288): 2024-12-22T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (261/288): 2024-12-22T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (271/288): 2024-12-22T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (271/288): 2024-12-22T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (281/288): 2024-12-22T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (281/288): 2024-12-22T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/5: Checking filesystem (288/288): 2024-12-22T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/5:</span> Checking filesystem (288/288): 2024-12-22T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 5/5: Finalizing scan results...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 5/5:</span> Finalizing scan results...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Scan complete: 288 files missing out of 288'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Scan complete: 288 missing items found'[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Removing completed task from active tasks list[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Starting downloads...'[0m
[37m[I] goesvfi.integrity_check.enhanced_view_model: Enhanced download task started for 288 items[0m
[36m[D] asyncio: Using selector: KqueueSelector[0m
[37m[I] goesvfi.integrity_check.reconcile_manager: Fetching 288 missing files[0m
[36m[D] goesvfi.integrity_check.reconcile_manager: Fetching strategy: 0 recent files from CDN, 288 older files from S3[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Creating new S3 client with unsigned access (attempt 1/3, region: us-east-1)[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Created config with UNSIGNED signature version and timeouts (connect: 10s, read: 60s)[0m
[36m[D] botocore.hooks: Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane[0m
[36m[D] botocore.hooks: Changing event name from before-call.apigateway to before-call.api-gateway[0m
[36m[D] botocore.hooks: Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict[0m
[36m[D] botocore.hooks: Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration[0m
[36m[D] botocore.hooks: Changing event name from before-parameter-build.route53 to before-parameter-build.route-53[0m
[36m[D] botocore.hooks: Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search[0m
[36m[D] botocore.hooks: Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section[0m
[36m[D] botocore.hooks: Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask[0m
[36m[D] botocore.hooks: Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section[0m
[36m[D] botocore.hooks: Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search[0m
[36m[D] botocore.hooks: Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section[0m
[36m[D] botocore.session: Setting config variable for region to 'us-east-1'[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Created aioboto3 Session with kwargs: {'region_name': 'us-east-1'}[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Got client context from session.client()[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/endpoints.json[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/sdk-default-configuration.json[0m
[36m[D] botocore.hooks: Event choose-service-name: calling handler <function handle_service_name_alias at 0x10caf2d40>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 1/4: Analyzing missing files...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 1/4:</span> Analyzing missing files...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 2/4: Preparing download strategy (0 CDN, 288 S3)...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 2/4:</span> Preparing download strategy (0 CDN, 288 S3)...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading 288 older files from S3...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading 288 older files from S3...'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/s3/2006-03-01/service-2.sdk-extras.json[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/partitions.json[0m
[36m[D] botocore.hooks: Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x10cbe5620>[0m
[36m[D] botocore.hooks: Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x11ea3f920>[0m
[36m[D] botocore.hooks: Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x10cbe53a0>[0m
[36m[D] botocore.configprovider: Looking for endpoint for s3 via: environment_service[0m
[36m[D] botocore.configprovider: Looking for endpoint for s3 via: environment_global[0m
[36m[D] botocore.configprovider: Looking for endpoint for s3 via: config_service[0m
[36m[D] botocore.configprovider: Looking for endpoint for s3 via: config_global[0m
[36m[D] botocore.configprovider: No configured endpoint found.[0m
[36m[D] botocore.endpoint: Setting s3 timeout as (10, 60)[0m
[36m[D] botocore.loaders: Loading JSON file: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/botocore/data/_retry.json[0m
[36m[D] botocore.client: Registering retry handlers for service: s3[0m
[36m[D] botocore.utils: Registering S3 region redirector handler[0m
[36m[D] botocore.utils: Registering S3Express Identity Resolver[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Entered client context, got S3 client: <aiobotocore.client.S3 object at 0x1250fae40>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: Successfully created S3 client with unsigned access configuration[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (1/288): 2024-12-21T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (1/288): 2024-12-21T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'cdb06f8b-6cb0-484d-bda1-71ba071cd169', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.httpsession: Certificate path: /Users/justin/Documents/Github/GOES_VFI/venv-py313/lib/python3.13/site-packages/certifi/cacert.pem[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6acaec1e-da4e-4d0d-b83d-eb140305806d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'aa78ecd0-ed34-466d-87c5-31ca92d8997a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c553ddcb-2de3-4864-8d13-7a380108db78', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b2033d2c-125e-4be4-a7c6-c8f728227780', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (2/288): 2024-12-21T00:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (2/288): 2024-12-21T00:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (3/288): 2024-12-21T00:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (3/288): 2024-12-21T00:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (4/288): 2024-12-21T00:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (4/288): 2024-12-21T00:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (5/288): 2024-12-21T00:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (5/288): 2024-12-21T00:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'PK7YYVTBCE2REKB5', 'x-amz-id-2': 'OvBQED46wAepaxm93ZwyDEHZUIUKbuyiCqC4iZ+wEsFSfwrIiPEEsuKtIp8ZI1WcKQ8pKN9mvPpR2GHkO3dp42UH0/XC1qJIDVGpZhOJGGI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356004000_e2024356004059_c2024356004059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:40:00 (5/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (6/288): 2024-12-21T00:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (6/288): 2024-12-21T00:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'28d0b2ad-ec2d-44b1-a0c6-49d161c5b68d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'PK7T0PYGT7YD11KP', 'x-amz-id-2': 'WaqPvr1GeAbS4CD5i+yoQ9f1dOza9ck1R6oEN3QAmG45t9nC3mkXEJvRMZ4Gf1yHQEod7rlRkqhW5d44cu+vewp0DsbRpffl', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356001000_e2024356001059_c2024356001059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6190cd81-ae2f-4487-8697-4eb94f7d9565', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'PK7P4MMN0BG505PW', 'x-amz-id-2': 'q6sSBRBO9gpPAStDSliYSvgQnUvI3p8HA5RoWMMn3Dr9ww0W5cursXzmbbQ9VjKHjm5xp/poi34L91MFAPe0Bv7mqZdG2olQxcN9WYxvD3U=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356003000_e2024356003059_c2024356003059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c95b272b-d7d1-45be-9600-b0b549ef6795', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:10:00 (2/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (7/288): 2024-12-21T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (7/288): 2024-12-21T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:30:00 (4/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (8/288): 2024-12-21T01:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (8/288): 2024-12-21T01:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV9GX4T1P8BSJDS', 'x-amz-id-2': 'GX3cnP0XOAfE5AQGoE4yQDBGa1+ufvvA1yAH2PRnKyOt2F6q68bnpFJA4ONPQJ2zVCgAPvJreSLTR7mSWSFig8HuoAFW7CrjiOiooFW0kvQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356005000_e2024356005059_c2024356005059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:50:00 (6/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (9/288): 2024-12-21T01:20:00'[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (9/288): 2024-12-21T01:20:00'[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'579422b9-16b6-4bf1-8526-6f1d6ae67a5c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV96VQCP5EDWTJ2', 'x-amz-id-2': 'uL2TmiW+IW09G+ioTGaFCQJEVAmuPVMNhErMYCZr5Tmdh9b3/kmccctX7cfHYKzYSbphpdAeHJKTiibO7PXMSJ6iqSmQBBVp+IOFE9nULkQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356002000_e2024356002059_c2024356002059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c80b8c7d-51d3-4741-adef-c29ac288658f', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV95CW7RRQS6BR2', 'x-amz-id-2': 'Pl9C3CKhdW3klrIAN6sB8JLfUJk/617B3clfdz7OC5ZGzXG38hiBUbU5N2KIcCcYKtx8EqmERCWKg/NBbZ6SaMcSlL4NSs2m', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356010000_e2024356010059_c2024356010059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ac4b922e-e743-4a60-88ae-9cf40ed7ad89', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVF00M1SXSW2Q4P', 'x-amz-id-2': 'qtRvXAoJoAVQHMgZ00R/dBVw/HbE6LlfLL8vAz825gw70lGKs5y5njRUgOzc3XzqrgyvxxKA0ZFovyGlI2gpAQInsONXPiz5xAbLxG9UrXg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356011000_e2024356011059_c2024356011059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:20:00 (3/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (10/288): 2024-12-21T01:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (10/288): 2024-12-21T01:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'135dd246-8a0f-4135-970a-0e15ed6f7dcb', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:00:00 (7/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (11/288): 2024-12-21T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (11/288): 2024-12-21T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:10:00 (8/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (12/288): 2024-12-21T01:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (12/288): 2024-12-21T01:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV9EKP1Z4NRX9G9', 'x-amz-id-2': 'e3JDfI8af0En1Kfj++jii1J/5jEu5q/WkvTUXVGTCsY78yn/eQho6MpzsFYAK4ish3lBU790D+4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/00/OR_ABI-L1b-RadC-M6C13_G18_s2024356000000_e2024356000059_c2024356000059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T00:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T00:00:00 (1/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e18b1789-d224-4f22-a4c9-7761858d9b50', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (13/288): 2024-12-21T02:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (13/288): 2024-12-21T02:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5YRXKATW95R63', 'x-amz-id-2': 'gTR+nC2w0SwTtHuoRk/Htj3MlzqQTM+LAztyupYbbeYGuKyP/OdJMsjE55VV7kw60KnRBmc1UWZ93p6+fZM0Lu8vFV+bbPRlq+Jv1W1Jw1E=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356012000_e2024356012059_c2024356012059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:20:00 (9/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ee7308da-2f97-442f-a546-3a6b22c02f49', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (14/288): 2024-12-21T02:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (14/288): 2024-12-21T02:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5GQS0MC8Z756H', 'x-amz-id-2': 'eeLYKupwpT5yGV83za086nSZy1Tv0fFnk9tyRV4/yXkS48ShoIQW+TbpcqnvmVY/JYsfvxGtKfQKJ3VDhAzLvCbzQr/d0LbS', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356014000_e2024356014059_c2024356014059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:40:00 (11/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'03ae1cf2-6380-4ba8-9969-fcc8fd3b4538', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVEACKFKBYWM09W', 'x-amz-id-2': 'atsa5PuSeDIg25kV6uIxWRUwvY5dvdN85ynCGwfpu7kGM37xi3A1XEfqAfB6gKX17fFSYgo6OQUf09ncnkgs5/0SDHTf7cx56E/UmdN8G9A=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356013000_e2024356013059_c2024356013059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (15/288): 2024-12-21T02:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (15/288): 2024-12-21T02:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'989738de-c838-4389-8f11-b4cea38ce612', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:30:00 (10/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (16/288): 2024-12-21T02:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (16/288): 2024-12-21T02:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV1FYBJ68EPS4N0', 'x-amz-id-2': 'GlykJhm/ThnoVEi+dh1Y5wZJkYyqzZ2lGDvYMsuY4ZeKB6iydYB+l3+tK7EfYla/OjeFUomNpnFsqVt+cwKnmASIWmmaj4ORbJI7E4/VPGQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/01/OR_ABI-L1b-RadC-M6C13_G18_s2024356015000_e2024356015059_c2024356015059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T01:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8135f021-9a47-4a08-9ff2-b8e996d2fd68', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T01:50:00 (12/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (17/288): 2024-12-21T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (17/288): 2024-12-21T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVF9ST9RMNDEK5M', 'x-amz-id-2': '8O6e1rWjjrcYGc4Nlp35+92EoBLBJ6pFFs0tlKELqjTnDVaOMkR62CrpD4FW5j//1i1s7PCZlaUkOIu3ae9A7mN3z5/zfNvOJ1nxxhxvihk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356021000_e2024356021059_c2024356021059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:10:00 (14/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'066eb1e4-2d13-4801-b85f-00a98b9b7546', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (18/288): 2024-12-21T02:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (18/288): 2024-12-21T02:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T02:50:00 (18/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T02:50:00 (18/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV7W4F7JZJFQGPB', 'x-amz-id-2': 'iDv9J6zNxbmVF2L1+ilOd7XDt4ZlT9vb7cXnPGKjN/1EAZjUeZfUybRDlCMktWn4C6umDJfolms=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356020000_e2024356020059_c2024356020059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'09ff4644-4336-4a5d-8baf-492f1cfc0b32', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:00:00 (13/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (19/288): 2024-12-21T03:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (19/288): 2024-12-21T03:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVFJXQG4HW8RK1Y', 'x-amz-id-2': '3omKdYoVDLkWP0ndEI3YqIukufEMPtCyJPgG6kuKy3PXvFBi2IaMP20AG9EXL8+wnWbiIS7qtonMMtyetDedvG+yPAKmiBBk', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356022000_e2024356022059_c2024356022059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:20:00 (15/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4297c5e5-1d98-4977-8f80-edb7cb9d9d87', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (20/288): 2024-12-21T03:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (20/288): 2024-12-21T03:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV6CT4SBX69ED03', 'x-amz-id-2': 'aa7yxTdLzIWcsmBSgrc/fp30vpiOokfXhNXlI5jDs7L/exlrNyH/bo/UYSS+Kj6fk2ocXQLGu+9mDkZD6zb+B1BZxW58Wpwczkcxz49p7Sg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356023000_e2024356023059_c2024356023059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3eb3eec3-91a5-43a3-aa5a-b4c10ba0dc30', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV2PDP6GE803G0G', 'x-amz-id-2': 'Dh+A576l3NTPCAZP7pmRyZswQl6n9x4U1WQI9woauAKmohV7C8RudZnZ0P+wfvsPdi1EdNWw6qVv+VcSQX4iNGBqPRnvDJINqG5OQ9+rlRI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356024000_e2024356024059_c2024356024059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ad085d38-ef47-458a-a101-ac1560bca606', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:30:00 (16/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (21/288): 2024-12-21T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (21/288): 2024-12-21T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:40:00 (17/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (22/288): 2024-12-21T03:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (22/288): 2024-12-21T03:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVES2ZVTCB2S840', 'x-amz-id-2': 'ZbWE/BpPe9O4UO3l/ad/NE+CXd1hSRlcCyt1wLh3OUrqhd9icO3valsDUk0+gLb3H6IBLL9UEXSl27MSRgl2rbWyNYT3MzhuCOuIAUFdDFg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/02/OR_ABI-L1b-RadC-M6C13_G18_s2024356025000_e2024356025059_c2024356025059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T02:50:00 (18/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T02:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T02:50:00 (18/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T02:50:00 (18/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T02:50:00 (18/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (23/288): 2024-12-21T03:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (23/288): 2024-12-21T03:40:00'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b51bb2b6-0fc0-4070-bd68-fe4aa76a4293', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV713GJC3C8DS4P', 'x-amz-id-2': 'YjRjB4tPQuhlvw0ue71R3T3EsH2h09lDZDAFpTnsZB1DxGH8+sWHMHHpxXuDm02J8Yqmq4YgoME=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356030000_e2024356030059_c2024356030059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'02d64ae0-d021-4e10-9eae-11fde63683b4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:00:00 (19/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (24/288): 2024-12-21T03:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (24/288): 2024-12-21T03:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5PNXWZPWV212D', 'x-amz-id-2': 'h9snYpgWvsTfDsLj4PDffOpvmY4vuqvvWN+km4BChvqqxTsxm50hXW96+y6kUGKIA0NIypzJu6+byFq7WO2xpJaEEmWdhf72', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356031000_e2024356031059_c2024356031059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5654982b-35bb-4800-98c1-de89b83108e7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:10:00 (20/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (25/288): 2024-12-21T04:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (25/288): 2024-12-21T04:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV8E3BZRKFZYMXN', 'x-amz-id-2': 'i0iagcXV4rw2D81abOS2usOVPhQI4sFIBp5lH5vDzkld75pirb0P6KDtOnY73a/0R+1T4w2hyrmzOnI9n05BVCE04NgqnC1ku+MD1ZeQPuw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356033000_e2024356033059_c2024356033059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:30:00 (22/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b35b8929-408e-4e99-975a-583252a421cd', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (26/288): 2024-12-21T04:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (26/288): 2024-12-21T04:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV0CJE7BHJF8C2N', 'x-amz-id-2': 'rHtwaBhKAt1GzVNYkjVuf0XPgurTNQjQZzW6CBkzA3B1+kWWsRmzExic9z8DlaFioquVRM2D1wVD4bRnQf0b4+Gdr3ZFch9xQPK9qc7XZyI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356032000_e2024356032059_c2024356032059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'12bef80d-3563-4210-a544-9953c3e4fc32', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:20:00 (21/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (27/288): 2024-12-21T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (27/288): 2024-12-21T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV1XB1MYRCPAKTW', 'x-amz-id-2': 'L8J4oi4g7WwD+Ey35Kj3rmxkAi0Cmj3sxw6Nz4QC0xGQfDcJHAVixrOlIIJhY3c7gm7q5QO4m0glwFd70iI6ErF69Z3JlR2pBPZskYWVRl4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356034000_e2024356034059_c2024356034059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:40:00 (23/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7c05a1b0-08cf-440c-a108-789d8f189e61', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (28/288): 2024-12-21T04:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (28/288): 2024-12-21T04:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVDA3SBMKN5VDN1', 'x-amz-id-2': '+CcBREsopdX3J9zYvytXXnYgzHH0D1az4mNwnS/T5WCqXj85Xt3kINCv/fMbFa+3TLtt8uSv46w=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/03/OR_ABI-L1b-RadC-M6C13_G18_s2024356035000_e2024356035059_c2024356035059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T03:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8598aa64-b01a-48bc-8e36-f2944c6a1611', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T03:50:00 (24/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (29/288): 2024-12-21T04:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (29/288): 2024-12-21T04:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV9X8KZC09RBNGH', 'x-amz-id-2': 'hPTrFMsQgMSFmtk8a2Q1RQBbGJ1Xb5lJiIcuenxoESHFL9r+gAMJqLQI8IM8TNWEP1n2FikE6TQC7zsEfR2cLlhJxCzmgF0M', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356040000_e2024356040059_c2024356040059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:00:00 (25/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (30/288): 2024-12-21T04:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (30/288): 2024-12-21T04:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c440cdeb-97a3-41dc-8038-b6d7d15f68c7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5T0QGSR9ZT9H3', 'x-amz-id-2': 'rlcy4/mAsIQ1Qp4O5Gl8GaREiIrjwJrum4EvBYEX5D8YnzYLS02CarVqfFL4HrM+rIL02C/MlzASH6Lf4ELCMl6HKLc0dCUtB+WbyImuz18=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356041000_e2024356041059_c2024356041059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a0bf1802-f7dc-4f87-9c40-b6a20ae829d7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV7PGN72XS2TC1S', 'x-amz-id-2': 'mS3bK3xYyxn21m/CRMBgHjUzp4tAP0YJBK3V3Av+ldzqYvHkVuMAQbBRTZOeTXidvVfgkb0PTbWCLRHpoN2vHzdkl3OwF3W7/s5DZtUXfCc=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356042000_e2024356042059_c2024356042059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'11a8a4c6-9f89-4427-8d2b-3e1a41fef25c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:10:00 (26/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (31/288): 2024-12-21T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (31/288): 2024-12-21T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:20:00 (27/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (32/288): 2024-12-21T05:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (32/288): 2024-12-21T05:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVF98JAJN7E91WJ', 'x-amz-id-2': 'n+NSMLbxCN5ubyx8FRimmKoff1hShqP4RJhmbfXcrRybKoG+XOJgJYWB+dTtiqiwKRNWo2Fawb5Nfs+XXzHzPKigBYy1K+cIxQPSIjDI1Ss=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356043000_e2024356043059_c2024356043059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:30:00 (28/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'24f07224-7dd1-4ac9-86a9-75b73045baf1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (33/288): 2024-12-21T05:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (33/288): 2024-12-21T05:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV9TWPTPS7ECFP8', 'x-amz-id-2': 'ZudI7EdZE8dAD7QozuEVPJ0KbZCoxcZroSnXYtUBalJkdx8lE5WF4yZHYh4ie9+QmtvtxLZH+dY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356044000_e2024356044059_c2024356044059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'29c0592c-0d2e-4129-aac7-94c1c68375d0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:40:00 (29/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (34/288): 2024-12-21T05:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (34/288): 2024-12-21T05:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5KRZ17QV1YN27', 'x-amz-id-2': 'wpEzgwaXdDxqGSHOutHuQD6GMBBByz89ziZparGiqm/dKSazyIuAnP2+hJ4p7OsSef0eAI6pFWZM7ET74Q0c43Wu3QdplffB', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/04/OR_ABI-L1b-RadC-M6C13_G18_s2024356045000_e2024356045059_c2024356045059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T04:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T04:50:00 (30/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (35/288): 2024-12-21T05:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (35/288): 2024-12-21T05:40:00'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1f917c91-7230-4bbb-a4f4-aaf42e0b0b51', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV1QAXHVVD7JT89', 'x-amz-id-2': 'Q0/BM0rUMC1bxPhF+7Y1FHAjsWRsqvl+4COtXk5x1zEFRQyhEkKSVRqvvBK5lBzfvUHyxinoQ0+et39sYfjrFXGKiRuHN7TPYD0JRevKfT8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:25 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356051000_e2024356051059_c2024356051059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9c526f4d-a678-45b5-b366-cc1326cae345', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV413EZGX970MRR', 'x-amz-id-2': '9R7BANhbLB+EZgIL5w1PlIZBiRRyij/lV6UD9sKrtBQ7C9QAhGTEiddf+xTUdY2LfBv0hHCk2zDF2KrGt/QOMe47uJYHikCfw3Iz+COdvbA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356050000_e2024356050059_c2024356050059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'93fa40e5-f4b6-47a3-86f1-87198ecfdfc0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:10:00 (32/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (36/288): 2024-12-21T05:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (36/288): 2024-12-21T05:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:00:00 (31/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (37/288): 2024-12-21T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (37/288): 2024-12-21T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV410DXQM5WF339', 'x-amz-id-2': 'B9pJBc0C6YM1sp+dFWnEQOdk7dWy5PwsIOrN8a3GKJskILwien9kuFxAtinRJra5l6n86BXggNWNXMqSQoPWLkid5jAibBuHB+4CXlBWDyY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356052000_e2024356052059_c2024356052059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:20:00 (33/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'12854364-4982-4683-8f9a-3881c2aa7801', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (38/288): 2024-12-21T06:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (38/288): 2024-12-21T06:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV91N8BYG61P2Y2', 'x-amz-id-2': 'i4c1tXYmjnxcSpSRENDEp51GkN8pb8x2YpUN41wALJC+IzE2GQLht1Z3Ms2TF3pYgq2ygJrqqlw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356053000_e2024356053059_c2024356053059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'248cae59-0a3f-4a26-9976-f54b7c79fdee', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:30:00 (34/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (39/288): 2024-12-21T06:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (39/288): 2024-12-21T06:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVBPYVC42M013W5', 'x-amz-id-2': 'ld7f08FqC4ln3mycQ07wbXYZ8OPNTtSomBRtew+EYklZi3yAg8tGDHTEvoRdzyXbIPKBa1NAjQWLyZXmS/2RGFOA7xIXl5aC', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356054000_e2024356054059_c2024356054059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:40:00 (35/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (40/288): 2024-12-21T06:30:00'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (40/288): 2024-12-21T06:30:00'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'619ec6d4-51ce-442d-90dd-03f076baf611', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV4JNEMN6NNFB32', 'x-amz-id-2': 'GBACPFrNtPzngaCoz6gwsC3Lip7hZQzCtrsf9zIx9adO0Ly3mudCjDhmPQc/vpG3J+uuQ9r0H80yZR/6YfNhZUevejICIuIZTRFvGNnFZfQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/05/OR_ABI-L1b-RadC-M6C13_G18_s2024356055000_e2024356055059_c2024356055059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T05:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T05:50:00 (36/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ab30d726-ab24-486b-849d-ed834fb74950', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (41/288): 2024-12-21T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (41/288): 2024-12-21T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVCHV5R6GHPR73W', 'x-amz-id-2': 'VKS4vC0nN3+jNhegUrCcMJUvPqzICrcoNpV8YbNCqYf6YCIjccsrTLN5+Oz9nxJO0nFlu8RS8bGm0gPvNQzCJA8EII6No11OyiDI0UxWPyc=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356060000_e2024356060059_c2024356060059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'575abaf3-7e12-43b6-859b-6a2c8e8d9452', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:00:00 (37/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (42/288): 2024-12-21T06:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (42/288): 2024-12-21T06:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVDXPTZ037VMJFR', 'x-amz-id-2': 'VkBUjl/4G7YYLv7adx8CKmckAiUDuVY9M1i2iX/Py4pjzlZtKSqatAlwQsMnhlfi532AUnkkNZ72bJM+Npvlo8k8EUXJDXz3cDXXnWXvpTw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356061000_e2024356061059_c2024356061059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:10:00 (38/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6e59cdfd-d887-4bc8-989c-15da742c05dc', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (43/288): 2024-12-21T07:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (43/288): 2024-12-21T07:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5P7S9EWRXTCNV', 'x-amz-id-2': '55o/B8TS1Pvste9ezHlXqthPmHxXeL56EM0VJpjtX+jp0/FdJY7TmSbxaodOkivUG1eraxiUjTg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356062000_e2024356062059_c2024356062059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'15df6826-2aed-49f5-8eaa-eaea76573cc2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:20:00 (39/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (44/288): 2024-12-21T07:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (44/288): 2024-12-21T07:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5XS0MKTS6MD77', 'x-amz-id-2': 'MHAsanvCENlmO7B4oWabrq29eH8AKAuUQMDESbrZzTIpWo4ufRXXmbFUwTdttoNzcf5Kt2fo2n9Xds4CtWGwX9zJhYakiUi8', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356063000_e2024356063059_c2024356063059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:30:00 (40/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (45/288): 2024-12-21T07:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (45/288): 2024-12-21T07:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ec94c1b6-6032-4ca2-af50-5b8b7cfa87c4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVFEC91JKJHG32V', 'x-amz-id-2': '7/ac8YKSGBxRiK2ohf2IDvNcmiQiYleC21U0IYNbqgRX7qqaF8JknhQLAOTyhTvXuyJWymD17x1sASytY+lvrDAvRt6LAAq1U3+ncUp9RJM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356065000_e2024356065059_c2024356065059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:50:00 (42/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'08189174-e242-49e3-9d72-f068f23b1542', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV2B03J1Q6S4K2N', 'x-amz-id-2': 'RPzp3dP5DMSq22R4vFCQ6udKtRPyuE/qwAsplXW9GpABCk68TUfTAvt+u2nXvltNF77BwuyWmInQUbA5tMNHVsTOk9ylR4Ax6XMJktH2RNw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/06/OR_ABI-L1b-RadC-M6C13_G18_s2024356064000_e2024356064059_c2024356064059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T06:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (46/288): 2024-12-21T07:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (46/288): 2024-12-21T07:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ba2eba03-e60e-4338-98d7-02a1b482ca1e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T06:40:00 (41/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (47/288): 2024-12-21T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (47/288): 2024-12-21T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV2R3PC7HH2VNX8', 'x-amz-id-2': '0ZpBiCZ9Sa/8H1ry7zKOxywSLTQBcxxIzeO9qxpFoMgW0m3Gguz8sUpE+PGP0ngFDsHdnaUZ6cGU3hzVfniEdkj4s80uzHDaeJ85R/gOGRU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356070000_e2024356070059_c2024356070059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:00:00 (43/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b86a519b-bde0-48d8-a589-90413382aac4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (48/288): 2024-12-21T07:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (48/288): 2024-12-21T07:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV3E6698155ZSW8', 'x-amz-id-2': 'Vr57bued4fdWMZS4/G9jKzoZf9+RKXWv/eCRLi2puU8aMpaozaRcNgc9k/r1b+TLeot+wUdo40w=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356071000_e2024356071059_c2024356071059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:10:00 (44/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (49/288): 2024-12-21T08:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (49/288): 2024-12-21T08:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'dd0047a1-a265-4ce2-b0e7-97c2b42908aa', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVAKEJMDJ8QHE2E', 'x-amz-id-2': 'TXuBDK0FxqOKNJdjBcWqZdcTHAeq1ePOzuPCw/q41hx7XMmE9NqJ4PdAdXQqMd6ttuLc7Ec5Wb8kODILkeGHn6DAai320JkL', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356072000_e2024356072059_c2024356072059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:20:00 (45/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2fa33622-04d4-4832-810e-c9b66e6cb0f7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (50/288): 2024-12-21T08:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (50/288): 2024-12-21T08:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVCH1NQ2RF0FDMB', 'x-amz-id-2': 'nrudX0GJS5JKoQScsHSYtyz/pu3jZF03KCoRy3II2EKd2q/KUyubqUB2pAwobC3GxYZuFijZx2khPEzruXGYXk7o/m6JZLKD8IAO8gYuWHY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356074000_e2024356074059_c2024356074059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:40:00 (47/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (51/288): 2024-12-21T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (51/288): 2024-12-21T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'80e2a5fa-9c36-4805-8fdb-2cd4614a686b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5S5YVB7SD56ET', 'x-amz-id-2': 'nVwdJ7mZzFSHdBcmWVt+ooUbempg0mUcxYej4elLinW3sJgkUbWOIg1IGUkk+QKJn1xxzuUwtQSTOGmjYX/8neyYgTxt+pKcDY43I7wtiW0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356073000_e2024356073059_c2024356073059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7536e552-353e-435e-8fbd-2badf661e522', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:30:00 (46/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (52/288): 2024-12-21T08:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (52/288): 2024-12-21T08:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV4KBJDFB4383BH', 'x-amz-id-2': 'VxOx+n2F9EozUb0avdGzvb2OUEdJSbAkQSt3mL7+K/GNPWeWyxW1/NpHGxw5Ko5+xXw6j4hFS89lgjJUUBdA8fZIBgjbGogvcA/QreV2zV4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/07/OR_ABI-L1b-RadC-M6C13_G18_s2024356075000_e2024356075059_c2024356075059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T07:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T07:50:00 (48/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ecaa8253-cc0a-4fda-bdf7-b2489ff1e2ab', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (53/288): 2024-12-21T08:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (53/288): 2024-12-21T08:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKVCA938BZTK6PSH', 'x-amz-id-2': 'AhFcgHjCr7unRxkW4rSctWKaStwEEsSWu4v+0bEZv153AMmrBJKHPWhBGtDvYJEPrGLCPdd/xUI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356080000_e2024356080059_c2024356080059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8c0f6252-2896-44cc-b390-69de18460f8d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:00:00 (49/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (54/288): 2024-12-21T08:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (54/288): 2024-12-21T08:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV5DRVV22D6AQC3', 'x-amz-id-2': 'yvXxYoJYU9bVdOVjbZJrXKRCuyaRWCJJ/iSXpQSFHwe38pWejzi2Q4m3UZmIlbv8MA0ez7IbYiNt1TmdLKEmHOEosriRhoxg', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356081000_e2024356081059_c2024356081059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:10:00 (50/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4543b8c8-f062-4211-beb3-513c02cb3a29', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (55/288): 2024-12-21T09:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (55/288): 2024-12-21T09:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV31ADFAQQ0VM8T', 'x-amz-id-2': 'QEn1vBF0gmwdjZ7kUeLGG0nIFVXCtEzMpVAIUyuPd/ZwE+CBL5Sge/nvAdIwip6JkYAsB1n9jZkqxQ8vlZp4iK/qXs8C9WfQkLYiVjM21XQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356082000_e2024356082059_c2024356082059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:20:00 (51/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'eaa14de3-60a3-4750-8a50-1078627c5434', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV8C9MC79RB6GAD', 'x-amz-id-2': 'kpLLX/tbfURSfdsx2f1foitF07+Ve7MkudhGrFqQ1a4RlTJFCUvrO2wqNmuwoCTwhFCCgK+1UJcxcPAtVNtit6w85f2cCFuJpnwm45Ne+Ms=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356083000_e2024356083059_c2024356083059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (56/288): 2024-12-21T09:10:00'[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (56/288): 2024-12-21T09:10:00'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'fc53f5c4-f0d8-451f-a9a8-05fe82c3ccf5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:30:00 (52/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (57/288): 2024-12-21T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (57/288): 2024-12-21T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV2VCWY20X6XBP5', 'x-amz-id-2': 'eJXiHu5L4GkIuJgE+oGXSmfthEiJNpdru3+HZmiDKqh5vodmXGV2Zq5lH6oV8QbvRUvsTROmmhAAhI0g+aNs+IEE5d4OXQcrZ62HgsfqaZI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356084000_e2024356084059_c2024356084059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'647e0eed-82d7-41fe-a99c-cda5a09d009d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:40:00 (53/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (58/288): 2024-12-21T09:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (58/288): 2024-12-21T09:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'YKV1GTC24YTFYKQE', 'x-amz-id-2': 'ElKLI48AQoc8DZipdQKEUgmvgDG+1luTkvXU31Xjw0J9gfomAijU6va2of+qAn+MmUO3b26iL8U=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/08/OR_ABI-L1b-RadC-M6C13_G18_s2024356085000_e2024356085059_c2024356085059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T08:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T08:50:00 (54/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'68220013-3329-4ce4-9671-1f8f93570301', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (59/288): 2024-12-21T09:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (59/288): 2024-12-21T09:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9JFX4C7NWMMNBD', 'x-amz-id-2': '8FTGAVXeZ3WK8Y6xQSx1ikFyQUAnCMCNqwnoQJsfpBSkRbk3cRrScxP4IPi/xLGGv90b6q6x+eYWYHBDM9u/u6YcSOoLgjMn', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356090000_e2024356090059_c2024356090059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:00:00 (55/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (60/288): 2024-12-21T09:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (60/288): 2024-12-21T09:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f32e4b9d-137d-4431-a030-aa2c3ae239a5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9VZGRTWPQ7Q9G3', 'x-amz-id-2': 'TC7MpwtuSrY9g47xNeiWXA7Ucod3FRfKseSV20M807SRzibtrcaDEkqiAsbbW6AtgffpaDU7ZkuPslNTnw3BMzLfk8fOiadiRG1IopzZL2s=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356091000_e2024356091059_c2024356091059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:10:00 (56/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (61/288): 2024-12-21T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (61/288): 2024-12-21T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4e24420b-e64e-4a2a-9a07-6078d1869cc9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9RGPAQDRBGKNRP', 'x-amz-id-2': '3OxUm47wKN4x6mhVmN8EkMXpC8D0aDZoP0nSXS1XWsq+ORitsKFWOovEcpPLGcbBCKVuZue3xjC4nmKigeX/TwoS7pXvnxvzJm2yiair1iU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356093000_e2024356093059_c2024356093059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a3f4ffd4-05f5-4405-bf66-e91483174896', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:30:00 (58/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9VZK82FZHJZ7XZ', 'x-amz-id-2': 'i4feqGcQHnVm5BB78qrJ8HQG3nMyq3l0/Q7ccciOCcTyNcFnqU/ou+ztIYk0x/ZUNJWFlhTAzFLe6o94kFLW+u9DN5zz5e9JJgdvJrd5w78=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356092000_e2024356092059_c2024356092059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (62/288): 2024-12-21T10:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (62/288): 2024-12-21T10:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bb66c3c0-1b89-4967-9429-15decccebe68', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:20:00 (57/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (63/288): 2024-12-21T10:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (63/288): 2024-12-21T10:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9M4JY0BR53K34Z', 'x-amz-id-2': 'SAc68YJaQ549UuRpMS+vm8VNWqTmcZm8sxDbBLONeNaIdYQdXhgC5BNbLFHfQ0D15hGPsixdw9I=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356094000_e2024356094059_c2024356094059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'229836ec-2775-4146-b42d-1a6b9312f69a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:40:00 (59/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (64/288): 2024-12-21T10:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (64/288): 2024-12-21T10:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9YBQC06R4M8TCR', 'x-amz-id-2': 'QyoV+MYTi3T0hp3dD6i++J9bmBGMwGKHcm/5uZXGbfkh+tT4sUHf/Xk7MwVrFyAZymlaOTm+M06YJ37Lnyf6s08LreT8CeDo', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/09/OR_ABI-L1b-RadC-M6C13_G18_s2024356095000_e2024356095059_c2024356095059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T09:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T09:50:00 (60/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9c50e79f-2dc2-4ffe-bdcf-1e4b561ddda3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (65/288): 2024-12-21T10:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (65/288): 2024-12-21T10:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PA7HXEN674ABD', 'x-amz-id-2': 'Cf5ndNAcAS8dKOJJm7xlkIDUhDyHhonwsuianBU0q97W+ewfT65gwNhN0M0o5pkiWVV1y8QchjqkYGOK7/26FggTMCay89z3irkR3f3qf1I=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356101000_e2024356101059_c2024356101059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:10:00 (62/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (66/288): 2024-12-21T10:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (66/288): 2024-12-21T10:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd5575ebe-f5ba-49dc-9ccb-ccfb36f98133', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T10:50:00 (66/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T10:50:00 (66/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PVV54DEA46FWT', 'x-amz-id-2': 'nm34N6+7zrn9LxQeO8huX6Cij7BKu1gcRpygZtSr2XEwNpl8X8+bZ+XxVFcBxjjcZU/PxftLfo7eKEvmkj+thwNf32IXfRI2JHr0t19Pkl4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356100000_e2024356100059_c2024356100059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:00:00 (61/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0647878c-c5b4-46d3-8f8f-38e981b33ca1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9REK8N2YX3KSMG', 'x-amz-id-2': 'ffxCkdQMW9YGFkPkliVKNQpnjEN/oEn1KHqhHK5tmUI1PaAJR902k01crKn5a/rDQufyz+nC3UulcpyEH6vM6Jn/7KcJk5elNcfgWY+k+UE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356102000_e2024356102059_c2024356102059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8ffea479-9b4b-471b-9b26-2b8565d260e3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (67/288): 2024-12-21T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (67/288): 2024-12-21T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:20:00 (63/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (68/288): 2024-12-21T11:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (68/288): 2024-12-21T11:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9XGGZSHEA4V4ZD', 'x-amz-id-2': 'EpYBtfrsAdNxnm3cSYbEEefQRFRYNfcKNhwMue83cGGR8RaumKcjVQTir+ufzG2Qbld+dyaIRG4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356103000_e2024356103059_c2024356103059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6468fda3-6657-4256-b37b-9e50708fd931', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:30:00 (64/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (69/288): 2024-12-21T11:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (69/288): 2024-12-21T11:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9H1CJ6BAP304JT', 'x-amz-id-2': 'Flatb9Ky5mXfzz3tvqNnBmbLfEt+LMKpPnI1W902gpR4mU+4f5Uz0YAdmloV66zTW5/Kk8W3u5cgRQQde8a9tpwc77rVFAnI', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356104000_e2024356104059_c2024356104059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:40:00 (65/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'850f58f6-a17c-4096-ac55-79c464046150', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (70/288): 2024-12-21T11:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (70/288): 2024-12-21T11:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9VEYSTHSEHS2DW', 'x-amz-id-2': '3Lcz+WAmo7a3TORhhf1nP6Xd2B9yO7G+5cNZ8NF+uZVh8gPvB3tZcye1Ke4j4TbA4L8CHE9lDQAfb40+UrXxFuMv6OhfX/LAVTcTXXG791s=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/10/OR_ABI-L1b-RadC-M6C13_G18_s2024356105000_e2024356105059_c2024356105059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T10:50:00 (66/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T10:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T10:50:00 (66/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T10:50:00 (66/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T10:50:00 (66/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (71/288): 2024-12-21T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (71/288): 2024-12-21T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c5fc2da4-c2fb-4712-8786-ff062a8bb143', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9K3ABMCNXVNYQS', 'x-amz-id-2': 'St3ROLPQLsXa+IqUSPIGlEl0y0LMuvgFP8s4PmUPYTpXlkKsuoXe5sIjiXeVEXZ9keLgQYZaIoz1OFbYE/dfJT9QoY3PMRe+moshqiWzgIw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356111000_e2024356111059_c2024356111059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:10:00 (68/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'71cee1b2-f6e5-4411-81cc-18a3848cc87b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (72/288): 2024-12-21T11:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (72/288): 2024-12-21T11:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9MV27MTJ7DNHVP', 'x-amz-id-2': 'mdsxru33ekFS8ghxwbUHI93bSujm+FDfZadp6ecf6e6rWavuS/3gjYNniiG2MXUHe8JUxmTTlhOMJRZ9GWQNq89AxVnRI6Frda9/9ghLhI8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356110000_e2024356110059_c2024356110059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ea8460b8-c65e-4628-b2a4-dbde58744e83', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PK2Z35DFMSHZR', 'x-amz-id-2': '2SOAY/G5Z/WujgUl9GyuH8rRp1Ke8NZt3S3uuOE/yP66tkSq5SODB5ETgIJtKhGVVHKDLHcqWc8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356112000_e2024356112059_c2024356112059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2a30a643-3e08-4a18-8f93-1738f02b0054', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:00:00 (67/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (73/288): 2024-12-21T12:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (73/288): 2024-12-21T12:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:20:00 (69/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (74/288): 2024-12-21T12:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (74/288): 2024-12-21T12:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9SWBA36PEGQQ4T', 'x-amz-id-2': 'eGRhnkpJh1wf8+cH9G9Qi2GypjEcUXUTs44Zi32IdOFL6Q+dmFd9yyGFzMrNm6B9CZ/eoE+4kF9HLWykEzUzHcgx+gRm+Iy6', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356113000_e2024356113059_c2024356113059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:30:00 (70/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (75/288): 2024-12-21T12:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (75/288): 2024-12-21T12:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'514a3771-354b-4508-8c9b-bdf9027d0cab', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PKEEH97AXF92V', 'x-amz-id-2': 'WdNfzbEnzyF8HKKeV1R8f5ceG9HLZ3uwtvSVVOJlXgbazfi9Y8So+vc+wi2aFADcy6RYhca/DBqBnoj3h5kB1p9qFdcrLYzM6hAciVYpMao=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356114000_e2024356114059_c2024356114059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:40:00 (71/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'995a3cdd-4fac-4f05-b498-ff304a24e8aa', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (76/288): 2024-12-21T12:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (76/288): 2024-12-21T12:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9GW5Y4C9279HC2', 'x-amz-id-2': 'YPeXYEIEoT5P3tuWcXb2TK8kiz4ea978xwfAE9zpKgNnwn9Y3tDRcdz5CvhVMMCUmIDttcsNL2QrtY2CDHG2jIWS/iFRjQioKv9X+dqJoRI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/11/OR_ABI-L1b-RadC-M6C13_G18_s2024356115000_e2024356115059_c2024356115059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T11:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T11:50:00 (72/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (77/288): 2024-12-21T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (77/288): 2024-12-21T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'861fa31a-ea96-44b7-b0d8-d4c6c13dba4a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9H98434AJCJ4WP', 'x-amz-id-2': 'K8kF/r1lXLTZzoLQpI0EolMcTz1ogk8ufh0G652HQjyksci3fBkpMkol4oZVi/AqU7rMCIWKm1c=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356121000_e2024356121059_c2024356121059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f3c3a696-71af-432f-9ea7-3205a5e2ab83', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:10:00 (74/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (78/288): 2024-12-21T12:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (78/288): 2024-12-21T12:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9XQNRKVDGEH79E', 'x-amz-id-2': 'YHLo9EFgOTWEiLfwTq6vW+z4SPOhXKntQc+kpZQKwf9NnFzTcMCpYIPZU+wmWqWt9am3Mx6WBPzzaukXnJKBGukRiEPDD+jxnXIBZl/7GnE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356120000_e2024356120059_c2024356120059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a4be9b5e-daaa-4f81-b439-28f855bf8436', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:00:00 (73/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (79/288): 2024-12-21T13:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (79/288): 2024-12-21T13:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9SNSP1J5Q6HRDG', 'x-amz-id-2': 'hhmpM7u9rfJ4+2QhY1Nhb06vUZYR5nrHGlMiK+ZW6Hp3C31GAf8ALySs/6ZvjwhSAKz/lx+AGGzVlxhuqd5Ds9ZQNmAQaldJ', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356122000_e2024356122059_c2024356122059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:20:00 (75/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7b77504b-0d14-43bb-ad9b-44f473630f21', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (80/288): 2024-12-21T13:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (80/288): 2024-12-21T13:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9RQ19KR0Z189CH', 'x-amz-id-2': 'TNKq8ftkNv3/aA+yu6BX6EmjiN9SenJqsqbFABJT5miZR9aEVoNCYG6j4keZwpW1gV9Pge6lxBIiLtDLQdyqvQ523hVY+RJ98KYrxs+1wYM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356123000_e2024356123059_c2024356123059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:30:00 (76/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'49a88eba-cb83-4c8c-a9c0-cf7effa87940', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (81/288): 2024-12-21T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (81/288): 2024-12-21T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9VHMXC7RD2KSWZ', 'x-amz-id-2': 'bkNwZ28vJrGQfg1Qsh7lX5L3dyEdalHFTCpWxfNcJgGqFq5gvRZwU1jvblIDHBk87+uHFQSvlBulaH1GifJdDFf/PYVkJmBfCZm09IQuF00=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356124000_e2024356124059_c2024356124059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:40:00 (77/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (82/288): 2024-12-21T13:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (82/288): 2024-12-21T13:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4cdd1e35-b0d0-43fe-9393-60ec6104fbea', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9QMGW2E5DHM7WQ', 'x-amz-id-2': 'OWO+zxWxzIxZx3/lWJaC/irGvE6yfU/bQwBVrZ9BAuO1kGEEoQEVc8Xy+rrVQlz7bSOLgJ85N2Y=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/12/OR_ABI-L1b-RadC-M6C13_G18_s2024356125000_e2024356125059_c2024356125059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T12:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'fc22e376-6d96-44e5-8236-e578b54141e7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T12:50:00 (78/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (83/288): 2024-12-21T13:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (83/288): 2024-12-21T13:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9TXE8WE0QBK4K6', 'x-amz-id-2': '3Bsf6L8tTmaymay7mbjcACCtK7UHM1TYKsXdhsMER0aRxC/HgeeP2mwca7b+Oq5JkN0pSNcV78Pbpk3VJ1/pRYvdE5tJsTHQoRGS1p4/WdI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356130000_e2024356130059_c2024356130059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:00:00 (79/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9a4bb6f8-bdf0-456d-aa8e-cf3f1082c696', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (84/288): 2024-12-21T13:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (84/288): 2024-12-21T13:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9JJVW9ZNV4V9MP', 'x-amz-id-2': '/iaEcvOk6EJLtg7bgPkBqVL9RAKQtkXMOC55A19b4v08EdPwL7CGH4iHWCN5tljou0DmmpsIAmjfFP4v0rIZtpvtz7ufKjVL', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356131000_e2024356131059_c2024356131059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5af4f8b8-23c8-4d79-a3f0-72ad4727c7cc', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:10:00 (80/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (85/288): 2024-12-21T14:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (85/288): 2024-12-21T14:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9ZP2EBBJ57XD3A', 'x-amz-id-2': '+ZDWcP4DtyvQu9bXziPsq2SMOCijC8B0+RVZmz7ubS6pQqbxuiI0FF8o77calHF/zc/0jWi29usIfMfTMRz3cuC6agpjcntyXs/iJ+3YAQ0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356132000_e2024356132059_c2024356132059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:20:00 (81/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (86/288): 2024-12-21T14:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (86/288): 2024-12-21T14:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'291553cc-89a5-4fd8-8919-c92d0dd00b38', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9QEDHJW22NDNGR', 'x-amz-id-2': '97dIrFjYGvT3cXTPJWQpw5QOwih1R7CEBJUwyrhFt8JSDdSz1gDaiZGVtqXa707HLqgiG4mRMIXy7/R1jBijj1BTQPFu6xBX/q1Yjqsg5jg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356133000_e2024356133059_c2024356133059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:30:00 (82/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (87/288): 2024-12-21T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (87/288): 2024-12-21T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7edf4e40-76dc-43ac-a753-6de60006f448', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9W0RBKTMTM2T38', 'x-amz-id-2': 'knoETrGWREZs+uJhUgmtgRfoaX8YNB5BdYa4ozQ+bxfERbfG64XyP0cXpOQFe8TCKyfSRKUUyso=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356134000_e2024356134059_c2024356134059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'62ea0d78-fe00-4911-8295-733b615dba50', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:40:00 (83/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (88/288): 2024-12-21T14:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (88/288): 2024-12-21T14:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PYAZFK798PBC5', 'x-amz-id-2': 'o1KgdA+CxFPsHgRyVgjFwnGq/myLy1ttum87mCYMazrhFaYfJyDZyqZ3cGkqwm4alDeZOaDU5BgDHucTiaL4/HTCB//QPDayjcbztsKullM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/13/OR_ABI-L1b-RadC-M6C13_G18_s2024356135000_e2024356135059_c2024356135059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T13:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T13:50:00 (84/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e59a788a-9ae0-4041-993c-b78b37a26ebd', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (89/288): 2024-12-21T14:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (89/288): 2024-12-21T14:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9M9B2CYCRD1SAJ', 'x-amz-id-2': 'ssB4nMwxdhNIJHYNo5VHudiz7FFuU7fVg2zbcCUPUHq8g2DRZCLFJpCGtHpNUqhxMbv0LizofnlZ7Pc00ASEHAXaiLyWKJuk', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:26 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356140000_e2024356140059_c2024356140059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'71758a78-107f-4ce6-90ec-8aa9da276ef1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:00:00 (85/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (90/288): 2024-12-21T14:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (90/288): 2024-12-21T14:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9JHGMVNK6P07Y8', 'x-amz-id-2': 'Qb0k1CHjXyWrPhTisz0+icTq3MZPHYsnLUAcfFjTWYFzhoyfuxlfCW1Q0YAkblo7wPNU+fIXsromRZybb2nAqvxgfvq1nJy+f2oa8Rdpskg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356141000_e2024356141059_c2024356141059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:10:00 (86/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e6dee514-6681-468d-af68-b8a843c41c68', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (91/288): 2024-12-21T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (91/288): 2024-12-21T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9ZK78J1G0GV4MQ', 'x-amz-id-2': 'rGRTfxErEvuSfEVbXUhSPMRhPv/PLibtum5m7BLx0dSQSsYdf9hu+yhiZOKAv1oZ1VdqjbSprC62dskJvyg8wfxYaMnuBs75R5Ugz9X+0KQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356142000_e2024356142059_c2024356142059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:20:00 (87/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (92/288): 2024-12-21T15:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (92/288): 2024-12-21T15:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'59caba96-6d3a-4430-aa33-4473fd16af9c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9N5MEE4EFE2FB1', 'x-amz-id-2': 'YF76NVLdcTQjO60p5gcFFY6QNJPor5l4pDOd1aLtvp/z46xtov60+iz/CasUGJyl60q2wRkZFGE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356143000_e2024356143059_c2024356143059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'23dff943-445c-41bb-bab1-22052de68558', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:30:00 (88/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (93/288): 2024-12-21T15:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (93/288): 2024-12-21T15:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9ZCBR7BM21MRG6', 'x-amz-id-2': 'CGf6XuSbJIbuO49B7V/SRMjmGqxWvFipCnYuGq3rXFxyYXg1+5RaO1lZTtuWN4+v7GV+zdcrcHBKjYN5heThLMQxhNVk+4dH', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356145000_e2024356145059_c2024356145059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:50:00 (90/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'00e6775c-01ee-4175-a813-66905140bcf6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (94/288): 2024-12-21T15:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (94/288): 2024-12-21T15:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PVCJQ4XSFB8N0', 'x-amz-id-2': 'jtg8/wyMu8g0vySXRQ7Hnlipp2NUSBT4+21CecQD4bmO0S5vt/NHCES9q4UOwnSB1xqrKDcmTQKKX6u0h+GbEn50Y1OnOeV0+RfAbHBLAD0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/14/OR_ABI-L1b-RadC-M6C13_G18_s2024356144000_e2024356144059_c2024356144059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T14:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c63102c6-b04b-4c3b-ac31-bd322b2eec5d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T14:40:00 (89/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (95/288): 2024-12-21T15:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (95/288): 2024-12-21T15:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9RRN5G2V4GWC8R', 'x-amz-id-2': 'LSwKD4ps1gbOT0r9O4FugqgzT83sVXoAY8A9SGYY60v+mmgpb0Myw7QPJEPRBkyjKhiJ0PlEEhoeYpJSk6IkfxYl6WDZctxck0nxm2lXlBo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356150000_e2024356150059_c2024356150059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:00:00 (91/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'694be0ed-549d-4b05-8e35-595cf5ff6cd6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (96/288): 2024-12-21T15:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (96/288): 2024-12-21T15:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9K905XXXF6JDZ7', 'x-amz-id-2': 'WvZpWV11kVrLBocJpYW6fdLlRlblNzBrsTeELx0SVC022lHwlrRDSyRL5aLRjdUkKgly+c0eJNo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356152000_e2024356152059_c2024356152059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:20:00 (93/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (97/288): 2024-12-21T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (97/288): 2024-12-21T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8e83b8cf-aa64-43a3-8fd8-9eead6331918', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9JQ09JBG15RC9K', 'x-amz-id-2': 'KSkxJQOZ4tW11DCJe2hySlIhZgZ1WsKEQAaVo78NvtvEB47lm+DQ80kAzWMjhFUoesSUUJv46CDqd+fnpWxEb4wXBsP6VLsIEmaqN9VhnSo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356151000_e2024356151059_c2024356151059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1f7ee0f4-5de5-40e4-97b3-efb8dee24b64', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:10:00 (92/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (98/288): 2024-12-21T16:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (98/288): 2024-12-21T16:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9HE5W42VEZPMTN', 'x-amz-id-2': '06r/WWM3EfW6VyKxBRX/IqdIMiucHymCskkm74XtpVC8rBRW6b/zHVzKzOP/aB/ANYXCREpQjAuhes2v7rzuwlJLXfgZFrD9', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356153000_e2024356153059_c2024356153059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:30:00 (94/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bd542e5a-5d09-4c65-908f-7263d400251e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (99/288): 2024-12-21T16:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (99/288): 2024-12-21T16:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9MRZM7T6CDD7MC', 'x-amz-id-2': '2ATSIBEV3V0Z2wX8IE8Z8ie/pAPeqOTaL6ylyWzN3jTSw+XNTtcEbrwfcjFZvR2qk2QI69WNoWliiOohK56Dy8LNMyoQOuVfo79WZN7NtLY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356154000_e2024356154059_c2024356154059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:40:00 (95/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'662a7208-5222-4298-b42f-22509af8beea', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (100/288): 2024-12-21T16:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (100/288): 2024-12-21T16:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9KYFY88J4DPMV1', 'x-amz-id-2': 'lzqEnmH8QpSUkzVrNZdzKQ+mFn/o+CABZIWc74KQWlg0HAcgXaxh/gYVeem/3fy9MDoIVbftsuY4G4TS3uCoGiEJv/3m9rZc705o33T45CY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/15/OR_ABI-L1b-RadC-M6C13_G18_s2024356155000_e2024356155059_c2024356155059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T15:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'297d5e28-3526-4ec7-a260-19efbd72fdc2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T15:50:00 (96/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (101/288): 2024-12-21T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (101/288): 2024-12-21T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9MHF0M1BW0J44N', 'x-amz-id-2': 'F6hQfKQtbJ4PFoD/TBqGTGKf0tY/iZCv1MGm5H9kMNs8rwyP274rNd6VIMaAmj0OWgvKUAifWB0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356160000_e2024356160059_c2024356160059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:00:00 (97/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b44cf089-7d88-48a4-8f37-bc1d49c1aa0a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (102/288): 2024-12-21T16:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (102/288): 2024-12-21T16:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9J8F7WKTYBCN5Z', 'x-amz-id-2': 'Obq1Z5sKdt9OBBzHCGDBqPv9de7mBb2oSdQXf022WmA8YY5jLM1/VKkNGdEE6D52Ni9BtD9RhTiQiPdWHO1TgcQ7iZA71ttyF/Cecgw0muk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356161000_e2024356161059_c2024356161059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e6b9ca5c-aa94-400e-a0e1-93c1c7a40601', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:10:00 (98/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (103/288): 2024-12-21T17:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (103/288): 2024-12-21T17:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9ZYPX675XJ1AY7', 'x-amz-id-2': 'LyeSDLVNF0wwR79Y2iapDTijqVSXxWJPRn2YKd9ATPyTgwDR6jF5pAgP7r8T2ovZvijVBo8/aRtfa7kkyVTPBLxCfr4IOL45', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356162000_e2024356162059_c2024356162059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:20:00 (99/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (104/288): 2024-12-21T17:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (104/288): 2024-12-21T17:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'13320b34-cf05-4920-8706-1c7101ef8c5e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9QDVC64Q46HBWS', 'x-amz-id-2': 'BjDzzxpJ+OiY9Ps2h3l/CWHa2evLz1zEjGzidbFBFjubM97PQYQ0tlk6l7ymV3Wgn2QVWnoaCp7CizP3R0JP8ErYAbi9RIycsZOSqV2msls=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356164000_e2024356164059_c2024356164059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:40:00 (101/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'cdd2e2e8-b221-456d-a28c-90b552b09dd2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (105/288): 2024-12-21T17:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (105/288): 2024-12-21T17:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9WC8B9H097WXMB', 'x-amz-id-2': 'vjTDDdpnOBRzBlCfpxX0RFZ3CBCIrJJd0PWFzru2ZoqNQdEdjp5j0pposLkTMXjSyXD4bX42AVslgDa3dM4bn08gQib4b0xsIl+lzhhTxN8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356163000_e2024356163059_c2024356163059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'343a117e-2712-4b01-8917-0d49c2e339b2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:30:00 (100/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (106/288): 2024-12-21T17:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (106/288): 2024-12-21T17:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9RS0JQB90H3EPS', 'x-amz-id-2': 'DZU5hNiypJf5UlM0HrjQ8O56hhOwJYy3V59BAU/gfnSeYEjPTeJ761ppkXX2XKSZaUOIPnAkLoI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/16/OR_ABI-L1b-RadC-M6C13_G18_s2024356165000_e2024356165059_c2024356165059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T16:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T16:50:00 (102/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (107/288): 2024-12-21T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (107/288): 2024-12-21T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'03ad442c-5ea4-45f2-9fc8-83f09c93bfa1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9MB99ZC83YK348', 'x-amz-id-2': 'hNDsbE3ChKo4n1vYGeJNUGn/CEdNlnq+Oad3SVR1wWr/OrffUAR5ARv2rwKrbBned+xiCGdUkOibjF80W3DpLm4iIirUkPUVZMHJ/vMVeFI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356170000_e2024356170059_c2024356170059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'615fdcca-b730-4b97-ba48-f38164b15b13', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:00:00 (103/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (108/288): 2024-12-21T17:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (108/288): 2024-12-21T17:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9T264P4VJPX8ZF', 'x-amz-id-2': '+SMAYZ7uMkQCn7XxTydBtk87kqmDTuU+bCHSpsiHQLg+oeqqg7/tu6Lbd/OE6OaklGaOTWjTsgiMOyrLYbe8URkcxfVUyS18', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356171000_e2024356171059_c2024356171059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:10:00 (104/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'35e7684b-4202-4915-b014-be7222d47668', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (109/288): 2024-12-21T18:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (109/288): 2024-12-21T18:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9T1V2J7MJ9NSDZ', 'x-amz-id-2': 'oap8p8ChFcJKpFK1T2eM97Af+8p5CE5DdCRc5iejkU6dgaY15CY6HoobMWQZ6yoQyA1lHTsIX/ytGCsXbjVHr13e+jiy+2ZHqKdqL/BdTg0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356172000_e2024356172059_c2024356172059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:20:00 (105/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'06ac453c-2d4c-4ff7-9a29-f2c24601c697', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (110/288): 2024-12-21T18:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (110/288): 2024-12-21T18:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:10:00 (110/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:10:00 (110/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '4E9PQNBWKA3TCM7M', 'x-amz-id-2': 'qGui7t4fKD+gWdg09Ton9AiaPStogxtH+lJzKm57ArqcbpF1xH99M9/6NgglzQ2LI2GTTo/idgdq6RDTGBTFI8eO9CMDXR5gcBaUunkigIw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356173000_e2024356173059_c2024356173059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f872c9f6-f5e9-4a67-94e3-b26e08ed76c8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:30:00 (106/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (111/288): 2024-12-21T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (111/288): 2024-12-21T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRNQA55M45XB2KT', 'x-amz-id-2': 'DEHTjH5DN2IkPZl/LIwN6jbUPRc1XSstWpoTXQHkpNCi2+RtDBEnzWmGRh3E581qAH1mMeu3W2A=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356174000_e2024356174059_c2024356174059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:40:00 (107/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a66b3f56-0ee4-4e19-8acd-9ded663eac05', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (112/288): 2024-12-21T18:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (112/288): 2024-12-21T18:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZ0014K15F2XY0', 'x-amz-id-2': 'lgBhs8jluC9swYP0rQZ9782fWdKl+xEzuHjF21gdqL8wBPCjSF0i4r7G4XVlJ2lQD6UIkVA6cOnmh1IisdaUuImNVXADrShTCTltZZYikLQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/17/OR_ABI-L1b-RadC-M6C13_G18_s2024356175000_e2024356175059_c2024356175059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T17:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'742a6283-60b3-449d-868c-abb3d163a138', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T17:50:00 (108/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (113/288): 2024-12-21T18:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (113/288): 2024-12-21T18:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRH3VBZERZ1J2WK', 'x-amz-id-2': 'x4K5pn6mLgJoiZrgm5fbhnFQTAkeTImd/OZdj8m86na7Rn7Oz2w4jXvtIDLCq3XsV9+rs46MKELBLXBTWLMXdaZ45jy+kBGa', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356180000_e2024356180059_c2024356180059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:00:00 (109/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'44990f3e-fc79-40e4-8f5e-e4b7257094b5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (114/288): 2024-12-21T18:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (114/288): 2024-12-21T18:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRT8FZ13TJB6APP', 'x-amz-id-2': 'eFWWhzxn6b2IyJqFINt1RN8Rr7RjIvvSfd3rY0VebXlZt91XQIB0G5PbsPVTsV3vffwd1Gn+uq9frc4bMBvPsUDhMHiIUai/OWiDTNelUWY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356181000_e2024356181059_c2024356181059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:10:00 (110/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:10:00 (110/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:10:00 (110/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:10:00 (110/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9ddec0f9-770d-469d-9b55-de3fb36c5fd7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (115/288): 2024-12-21T19:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (115/288): 2024-12-21T19:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRVASW6WMDQV5Y7', 'x-amz-id-2': '2BAW4lo8gR3ByDsqiN4sGbEOLI9tCswoL415OUIDuV47imGbRap/zB8iZjGTwStibgVmS+302bOmGKyevjxzkJxlFyoYo1XI50/jryvRV6k=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356182000_e2024356182059_c2024356182059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:20:00 (111/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (116/288): 2024-12-21T19:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (116/288): 2024-12-21T19:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2a425ddc-eda7-4f8b-9aa2-ea69c0df3bc4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKZ1Q37JH882T7', 'x-amz-id-2': 'Z5WHup45LIn727zoeMN5k7JMX/iMtvCQlMcwlfuN8vAbqVYX7SJlzUvgGIWcc9eGcXArXtEiu6E=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356183000_e2024356183059_c2024356183059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:30:00 (112/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ffd6d8ac-8f41-49f1-ad8e-76db7f276b4c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (117/288): 2024-12-21T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (117/288): 2024-12-21T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRGDZRFNSV5YE3C', 'x-amz-id-2': 'dRb4QZwgoCgxYoVKC+k6Na76gkQM+GqGUp1UYJa1hS5MKMaYE1HXZCJrqasHSqvHzwk88mFhVSCeRYTiTULUClMLaFd31nIBS7aAHNy85Y0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356184000_e2024356184059_c2024356184059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:40:00 (113/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'908cd8aa-1a5c-4d8f-a12b-5c1fb8b12d7f', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (118/288): 2024-12-21T19:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (118/288): 2024-12-21T19:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRVVM4KTXWSHJWX', 'x-amz-id-2': '/ufwML8+kbIzymraXweJ5HoQ3mLev56zhAxhnp93/DJYBKDc6A7xWuSEXfONPevRVoHRPVUEs8nZlQLPP+whT7Qkg7cbesYV', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/18/OR_ABI-L1b-RadC-M6C13_G18_s2024356185000_e2024356185059_c2024356185059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T18:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T18:50:00 (114/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ace732f7-7fec-4fea-a3b6-b2e4cb8d6c3d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (119/288): 2024-12-21T19:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (119/288): 2024-12-21T19:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKBPZKJZKFPK5T', 'x-amz-id-2': 'Ema+m398myhpEOYr3dFv2NYnIvIyWrCWT27WG4QL33KBJ17l7tztoJofYQs9JTIN1jVUytVwTxsLBaRoKGasxJhPKioGaqEog3KEh8KBVQE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356190000_e2024356190059_c2024356190059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:00:00 (115/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (120/288): 2024-12-21T19:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (120/288): 2024-12-21T19:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'31147185-ab72-4692-adba-6f04fad00f0b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRHQXWQZJ8JVNEN', 'x-amz-id-2': 'hcWZ30Ii0EJdD7b1Va/etnGg9tnxBkcUgUOHcgGH5FqSHDcSEb65SVkcsINJDeQ6XaNuB0HiAksRX+gcRDqcAg3ZdcSFfujR1I/u198BbUk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356191000_e2024356191059_c2024356191059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e1847ff0-8f00-45c0-a57e-c4e064d45e97', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:10:00 (116/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (121/288): 2024-12-21T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (121/288): 2024-12-21T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRQJVQNQXE6D09D', 'x-amz-id-2': '3TfoB4fg7vHzVy+u7z6PcIVC57z7P4GEX30WBij5FU04EPk2yyyilpWeZhFTCsHjQ9p1mYQrLjc=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356192000_e2024356192059_c2024356192059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:20:00 (117/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (122/288): 2024-12-21T20:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (122/288): 2024-12-21T20:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'579659e6-fdf2-4685-b189-c9b43f664ecb', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRMX4PMVR5ZDYGJ', 'x-amz-id-2': 'jGoJwE7//uW/mXngT3XVEq4aPDa8ornTxmOlXEXN4qX3TLt3ssiTp2ISyvpl1GfbkxVd/7Dl07tsKR1SJoWEAOdscYdUh60hBHpfYYjp/1M=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356193000_e2024356193059_c2024356193059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'26ef75e8-fa7f-40c2-959a-137652ce1895', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:30:00 (118/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (123/288): 2024-12-21T20:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (123/288): 2024-12-21T20:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZQSW7D8N6WJQH', 'x-amz-id-2': 'SZr6paawU30SleESwnO7nwQnzKwzkY8UuQU0HM3Z0LkS53GSw5tiMHBepS42hLbwcwaEpFjIdqU5wY567725F3zmREWWifHR', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356194000_e2024356194059_c2024356194059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:40:00 (119/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'31d41f1a-cf25-454d-9151-7c164ea03ca6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (124/288): 2024-12-21T20:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (124/288): 2024-12-21T20:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRJTGW1Z3JR2AJ0', 'x-amz-id-2': '5N3kDQYkhbBgRbXBHZbtMfpkC6eWdoTzSU3BcuMBBBtrHl1cb05NvW2ch0R7XbfxtH0wrXjUA95Q0rL/0wYMuv/ut4hG2ykJV4iVu+YS09Q=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/19/OR_ABI-L1b-RadC-M6C13_G18_s2024356195000_e2024356195059_c2024356195059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T19:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T19:50:00 (120/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'61a37fcc-04a7-422c-82da-67b2fc16d8e9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (125/288): 2024-12-21T20:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (125/288): 2024-12-21T20:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRG2PJPVNQS0472', 'x-amz-id-2': 'MDq4Df6QOHQYXKwyQIsavnITB1k2Xyi0/zz0hclu/aauzAHniXK+1roOr4VE4sDfuGBDkUBUNCHUhy2eZ9EX4gjTooEpkwG/5o2SqWDEOIE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356200000_e2024356200059_c2024356200059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:00:00 (121/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bb0bbc6b-fa07-495e-8b72-3be52af570cb', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (126/288): 2024-12-21T20:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (126/288): 2024-12-21T20:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRVDMXCAPA6NWKF', 'x-amz-id-2': 'GUwd9ZD5cCbUNf5xdy0fHZfqVkmFp0RAX8Y9TIxQSHr32JHjkD6vezdW4ihZkCyDTsYFxWom4qw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356201000_e2024356201059_c2024356201059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:10:00 (122/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1513c84d-2dd7-4453-8604-2a24a77cd92b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (127/288): 2024-12-21T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (127/288): 2024-12-21T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRRHZSMY9SJYV6T', 'x-amz-id-2': 'UEGy/8PU2RXldN2irpNFzbVjvkLLx0lUOqTrIExLTGebpfIGqibTjPWe/kP2V+yBORIL33Ao8vh1qgst/pzA7bi9BWh/4UtOyp7L2ExE4YA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356202000_e2024356202059_c2024356202059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:20:00 (123/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8cd804cd-41f6-41b2-8e65-b8fd66b57491', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (128/288): 2024-12-21T21:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (128/288): 2024-12-21T21:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRT7VCRSWP5JACY', 'x-amz-id-2': 'SnOMettQsg1wUPX3+4jTB6WRpIdQv9Pd3VDQ3zDENjeDVV+0vCS2NOlW0EzbLaS3lfZmVJbkIOmqHRDIzKAVSznf1VyI5RHE', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356203000_e2024356203059_c2024356203059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4e56e0f4-44a7-44bc-863e-d20a059781ed', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:30:00 (124/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (129/288): 2024-12-21T21:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (129/288): 2024-12-21T21:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKC0GZES24N1ZM', 'x-amz-id-2': 'kwgffYTubWBEdOJyzcl3lellXvN4OS5u7hUoi9BqD6YpPbWDV2rzHfqR0Lc3QMs0w+1uZubB6NJIp7gfXa8ZrVgOhQ3Xr+dgI2ud+x5yxgo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356204000_e2024356204059_c2024356204059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'fc794a84-db28-4b6d-ba88-583033ebc3c1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:40:00 (125/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (130/288): 2024-12-21T21:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (130/288): 2024-12-21T21:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRJ3EQPMKA5RDBH', 'x-amz-id-2': 't0IPmwlvsf5fC4H/vM3PN6oSXkr5D6wwUxnhCfl02tcyGhdaW8vHv9DErA+49+jxslYgu/pXC9sSJBnLAExWdFf+sbVurygGYggzm0DR2fA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/20/OR_ABI-L1b-RadC-M6C13_G18_s2024356205000_e2024356205059_c2024356205059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T20:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T20:50:00 (126/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (131/288): 2024-12-21T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (131/288): 2024-12-21T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3d614fa2-ceb0-40e6-ae61-8ad0db96ec54', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRTK9C0K97VHM65', 'x-amz-id-2': 'g8PobIY3oVJ+pedrcPqjRoFs/D7ctHg4Zdx4oWzAKY75RtEg7PRfZCaMzKyQqVeOavu04EOTbSQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356210000_e2024356210059_c2024356210059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'91a44b92-f97d-44d6-bcc7-5b6efec8f1ac', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:00:00 (127/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (132/288): 2024-12-21T21:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (132/288): 2024-12-21T21:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRXYMVHSDA6CVTJ', 'x-amz-id-2': 'cXletDGTSHsjx00mzEw7aSr/thA9fPryx5i/SQbFrZZnYvswsuRFylvHRX6CD1o04rahOgKO5pSMOIEeKciljBLsINWdliAvgjFODGScQMc=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356211000_e2024356211059_c2024356211059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'de197d03-7271-4af4-8680-bca9d6317e00', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:10:00 (128/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (133/288): 2024-12-21T22:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (133/288): 2024-12-21T22:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRNHJ1QKHGK8WHT', 'x-amz-id-2': 'FEfMIZZQssIYlnhY50tJG2vh2EGhg/6ZUqA8vtnoEMTYRM/rYp0dpqOATohf4Zi7N8tEDjKs8jpGEEbSjbeQPBOLYlSsctza', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356212000_e2024356212059_c2024356212059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f25c18b0-2e6c-4182-a9ea-6a89e8d86d5f', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:20:00 (129/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (134/288): 2024-12-21T22:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (134/288): 2024-12-21T22:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZDDB1FDTVZHBT', 'x-amz-id-2': 'KKMvgcZudG5kXF2VmHfxo4SUF9fG+uJAJ4w9sLG6JG6EKcigi/oXEWWDFkZGT/Z0SFLP4ynrq56jptdAXNHHol8P/UMVVzzMh18k3RJpvr8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356213000_e2024356213059_c2024356213059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f61dd712-4e07-4564-b8dd-b6ff6baae856', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:30:00 (130/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (135/288): 2024-12-21T22:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (135/288): 2024-12-21T22:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRMNK365GZ36CNW', 'x-amz-id-2': '60/xD6dJhbJ833AhpmLb5LH/ua8ohHsveG2Egnut5GC0j1Qf/X6Kn8JnNsk+cTAttltudaS6OiE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356215000_e2024356215059_c2024356215059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:50:00 (132/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (136/288): 2024-12-21T22:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (136/288): 2024-12-21T22:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a4ecc4c2-f3fd-4954-831a-088ab376fa1a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRMR002Y78ZGW23', 'x-amz-id-2': 'qAd/McXAbw2qWlF94o7/5w45Y9RXBKuK5rrMXwwbWQI6gybXTdzF6lR5nQdnE34xmT3jz9x1OTVBl060K2iAUxmVx/Kywvl/3MuZRHUsw1o=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/21/OR_ABI-L1b-RadC-M6C13_G18_s2024356214000_e2024356214059_c2024356214059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T21:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T21:40:00 (131/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1cdc231e-78a9-40ad-8109-a47f1efe730e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (137/288): 2024-12-21T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (137/288): 2024-12-21T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZ046E5T6SVXHR', 'x-amz-id-2': 'aFZEDPle37i5mIkpyKDEJngPr4ueb43jfF3NoIQVnQ/BcXovnNRbqU+hutS0uQrBJ+d7/d0C40Ri1KO3SbHSwMvfOs/pFI60FLlQ2UBFPJ8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356220000_e2024356220059_c2024356220059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'443d7b6b-1168-469d-8dbc-29faeb093b82', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRH6WVM8EQSGJ5C', 'x-amz-id-2': 'ImHpOjniQC0KmqCRbIUj/rNHs386RQ++mqpNEW5KlX++EfEaJzM5KU7QEaL1s5X2TRr8oOL76BQhZQOnAx5mq0gY5zzboZZh', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356221000_e2024356221059_c2024356221059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd1ddd9d5-9fb8-46a7-a7f3-e49b2053a088', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:00:00 (133/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (138/288): 2024-12-21T22:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (138/288): 2024-12-21T22:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:10:00 (134/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (139/288): 2024-12-21T23:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (139/288): 2024-12-21T23:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRNNSM0WE10YV12', 'x-amz-id-2': 'rl/oIAZfzDW/bbo5ntSqy7toSNcSmtQN1g1njLOSfnaskhNf5r9Ltqi5qvRi703me5mzoJjFajzFYFTYSnvVxxkZCYeDPggOPqBx5sS8jhw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356222000_e2024356222059_c2024356222059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'cc9b28da-114a-459f-98fb-ac66f91bcc0c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:20:00 (135/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (140/288): 2024-12-21T23:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (140/288): 2024-12-21T23:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRXH8E33Q0NYWFC', 'x-amz-id-2': 'JOl4THjAe7Dus8Y4DNr4Iy+WgCsswiiL4S0AJhxPO4+CIqHue4gP01GVde3bL/0iWWCia8frXoE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356223000_e2024356223059_c2024356223059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:30:00 (136/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6335128a-234d-4b6a-bebf-c4d1c5a929b8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (141/288): 2024-12-21T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (141/288): 2024-12-21T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRWD75WN9SR1Y3E', 'x-amz-id-2': 'irtvbtup6NjncMn0DojAuIvgkYAYK2mUDQg2r7+5/R/xP7wrXi9W4UGcbcY3CUTEOCJojfYCtfZ0TI811zflF4nWjS0Mn4FcXAFOXLxUKus=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:27 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356224000_e2024356224059_c2024356224059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:40:00 (137/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c21e7644-4181-4b4f-b6e4-3dc2b7770e67', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (142/288): 2024-12-21T23:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (142/288): 2024-12-21T23:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRSVVED180N0CFE', 'x-amz-id-2': 'BxG0Rfes1gYGx/1113tXucgPSu3IHz3JW20NBv5Je/qd2HQ1d/SPdUEKx4skfBXm51HsZJwIs9YReDrq8nV/p3/uiCvK075i', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356230000_e2024356230059_c2024356230059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c2da0714-79b3-45ac-a403-e6fd2969a4c3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:00:00 (139/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (143/288): 2024-12-21T23:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (143/288): 2024-12-21T23:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRPEBRJWXZ7E2GG', 'x-amz-id-2': 'ioFq9RD9Fwu2CaWkAXnhkY8xiEOG5P8vEmfw/cTCrg5Sq3Xb3zt/W5SPyw36As3WUr5qXypVrTdK9CL5leKY6TBA0zODLF2VwtcjnGKLJik=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356231000_e2024356231059_c2024356231059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'11d65dd0-b375-4b53-b130-39ed397d70cf', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:10:00 (140/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (144/288): 2024-12-21T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (144/288): 2024-12-21T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRT515BN8CDX2HJ', 'x-amz-id-2': 'Xy1LN/UFvSiOQKKsTxu/s3Tdn+RtfhWEBPjRR1RRy5lfr4wC97iWpEODX5/jpTnS35nfHSccTVwKMDZRUi/3IFfv2aG4Pk2J2sF5WqyHQ+A=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/22/OR_ABI-L1b-RadC-M6C13_G18_s2024356225000_e2024356225059_c2024356225059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T22:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6e12bfff-4089-4d9d-9017-f63859b0dd22', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T22:50:00 (138/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (145/288): 2024-12-22T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (145/288): 2024-12-22T00:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRWC2A00BPFNQKR', 'x-amz-id-2': 'tuYlwbe8nIsk7xL6V31lzAUXzh/NOHWadqZXXThoWiyVEcpbvAptrn6C+zOIynUu7LYuKOvxBPk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356232000_e2024356232059_c2024356232059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:20:00 (141/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bfb3096e-7f8c-4691-9b9a-5da92569518e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (146/288): 2024-12-22T00:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (146/288): 2024-12-22T00:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKXD14Q8JVTC5P', 'x-amz-id-2': '9IFtx/l+1FB6Gyy0oAtiz5fs4hXan3Pntl2TWxSIT01//PVti6ESFCEaJfNZbQpmroQsrxYv5nxo76J8BEQdVYCJ2hJMBQhS', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356234000_e2024356234059_c2024356234059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:40:00 (143/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'079a5317-3562-4f74-8020-2e2fa1e17a1c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (147/288): 2024-12-22T00:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (147/288): 2024-12-22T00:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRX56GNTXYYC944', 'x-amz-id-2': 'pbB2qpdnLxPYYjEXi/+2p7KX1Fk1xDaAYqCITZhB7eN7SsRF2ltPpybbIg70JIujqY/EgNnwpk7Eo2DnJD2aWw3q40uWsLtopM2HAO4SAEs=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356235000_e2024356235059_c2024356235059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'929fb6ec-5165-42eb-ab42-af8a783a5e8c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRMJJVSRRPSMEYX', 'x-amz-id-2': 'lsgrc2IJOo9wNKlS2EplFdCqIPUUNzqTYzp/yCah8mJJK3+2RbQBpvGvhm+MivavaYRDbDInr8FtdnE1CY+19xZF7NQVTMzRYCUcZbPUkOY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/356/23/OR_ABI-L1b-RadC-M6C13_G18_s2024356233000_e2024356233059_c2024356233059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-21T23:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'da8d3e09-a17f-41fe-b2b1-790f177dcb2d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:50:00 (144/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (148/288): 2024-12-22T00:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (148/288): 2024-12-22T00:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-21T23:30:00 (142/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (149/288): 2024-12-22T00:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (149/288): 2024-12-22T00:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRQZQJ047PSAT45', 'x-amz-id-2': 'QHQbrkgmMFkut7dMyEr6Vb+90OBNdEYHlMMx1eHDcrnVEyhWLGsRDHj82FeMDY8UdWv7m6eYJmJyb6oyP+9tID911Nrqo4S1+ewiMZsGPOk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357000000_e2024357000059_c2024357000059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'fab73780-0a4d-423d-86f1-71fd6b559763', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:00:00 (145/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (150/288): 2024-12-22T00:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (150/288): 2024-12-22T00:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRPEC94AK6G5F32', 'x-amz-id-2': 'Z2iARoJ2KGl6SaboPKFQ16QonEnNQbYtBDVIA21R/9tT4J0OtCEbvohTxb2irKroElb+E9FWssM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357001000_e2024357001059_c2024357001059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:10:00 (146/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (151/288): 2024-12-22T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (151/288): 2024-12-22T01:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'00fba266-0080-41c8-9234-967fa9382b70', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRQAEYHEJ0JZW3N', 'x-amz-id-2': 'ymF72/qD6ZtNKV4LNYl7gvGuo8rOdDJEnUa7kV/wJsMXUkSdGCdcWKb7xCZrarG4qMeO4jqvjuRDiTJDNz9uWeTEeOPddZDx', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357002000_e2024357002059_c2024357002059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:20:00 (147/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9864a138-537a-4a4e-afd4-afad34a6d833', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (152/288): 2024-12-22T01:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (152/288): 2024-12-22T01:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRQCRR9540P6SRP', 'x-amz-id-2': '6hnQWAaQydNtTDno3KbIrxjvKG9CjSSEuO093OrN5q3yOSyvCVWok9DRo/5CjipF0mtt96J6gmRUvaIjzly2a2FrBRv+r+pDs8lkk2hmNMI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357003000_e2024357003059_c2024357003059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'77683245-b79a-416d-9a15-2c4f22f72aac', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKAA6M37DWQ6G3', 'x-amz-id-2': '31V6XfdzDs+Pm/Z2UyZUBleM5Ue40oyIxBZXzHaRmFmxo9Q+eD2YxIjLJ6kTLlZL+qSfuDFsR6d4/HwsHovQjNI/L9vUCYydO8uvr24XHBM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357004000_e2024357004059_c2024357004059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:30:00 (148/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (153/288): 2024-12-22T01:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (153/288): 2024-12-22T01:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b91061d2-2e0a-4ee3-848a-ba9f1eecfd2c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:40:00 (149/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (154/288): 2024-12-22T01:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (154/288): 2024-12-22T01:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKCZ156PSA9C0F', 'x-amz-id-2': 'wXcJ2HWTkVkeLy2zM6cDXQ3KLzrVgbs16N5FslA6Gu8gsUSnm6jpF8WBwKUAZ7taylLx4s98oe7UIYpHbl++MVrjqer+hBM2Vsd65cXd890=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/00/OR_ABI-L1b-RadC-M6C13_G18_s2024357005000_e2024357005059_c2024357005059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T00:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'937425c4-e1f7-4f27-8925-721752a3dfb2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T00:50:00 (150/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (155/288): 2024-12-22T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (155/288): 2024-12-22T01:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRVJRVV0EJG5PYM', 'x-amz-id-2': 'QlYjftjayrD7LlYxMJLTcx4F8j99ltNMNrZurdKKpaO2dcXXD0hbjBIcvp6GQ+SE/yTEgxtaDI4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357010000_e2024357010059_c2024357010059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:00:00 (151/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (156/288): 2024-12-22T01:50:00'[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (156/288): 2024-12-22T01:50:00'[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0a03662b-75f9-4659-9c0c-224fbc40dbc7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRH621EMED4AN0Z', 'x-amz-id-2': 'w2JAAP6uTQhHziQ098mRGZjKdOGYQq2PLYb89wKV+1KeauUCGrs4pvJ5d1UWK1s7/+oMnwaHJaaFcn/LfE+wUuHby4YkpXLgBup8YLrEPQA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357012000_e2024357012059_c2024357012059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:20:00 (153/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'21fc0cee-27b9-4fa0-8aef-038036fad6af', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (157/288): 2024-12-22T02:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (157/288): 2024-12-22T02:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRVVTAZM4FDGR6M', 'x-amz-id-2': 'OLsbeuxl69itZf9s+5zvmnPZ8J6qbb33Ap5Gx5szJSQEH4raMsBmMtBI50Pp99zee9XHQbVIGcO+ezlfC/kAVALckGOliCit', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:00:00 (157/288)'[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357011000_e2024357011059_c2024357011059.nc[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:00:00 (157/288)'[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c434b09d-29e3-4288-8335-179e93067b3c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:10:00 (152/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (158/288): 2024-12-22T02:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (158/288): 2024-12-22T02:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRPV1DEK87K00DC', 'x-amz-id-2': 'nTiVXwtqAFS2w9m0soCu8KAOAjri6Swbh3yD9TWLrDp4mu6WqwTqN9PnQRaLI1DIMVlYslheec20Z836yZc1PJtopE7UCjW6Bn3nef33Q5g=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357013000_e2024357013059_c2024357013059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'18cc7ec1-5b74-4a71-9f1b-44f098adafc3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:30:00 (154/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (159/288): 2024-12-22T02:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (159/288): 2024-12-22T02:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZZ5XAF6XET1Q8', 'x-amz-id-2': 'H2Y44IfCy42ncFWcNOIUk6Mq8+0tZYO3PJzl9TM3gnmlRKoKd9lYXwJLd4XzyE22seHuR2KzBNHvknkgF7N/VR06J8sqSc3rLD8SteA/6RE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357014000_e2024357014059_c2024357014059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5591e9ea-6b24-4d51-ad9c-2a3249ea4a1b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:40:00 (155/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (160/288): 2024-12-22T02:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (160/288): 2024-12-22T02:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRKKRZJ01D2N82F', 'x-amz-id-2': 'UPeLMvARe28WEjKddyFPCNzsETbVzvq5FOaL/e8/Dkv5VwyMMhZOFXT+fmFHGnIDUKAzO4kKWGI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/01/OR_ABI-L1b-RadC-M6C13_G18_s2024357015000_e2024357015059_c2024357015059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T01:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T01:50:00 (156/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5a943edb-59dc-44af-97c2-c606c0781352', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (161/288): 2024-12-22T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (161/288): 2024-12-22T02:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRGE1NH5CH2K412', 'x-amz-id-2': 'ORekBWblBsARIHBFycqpwAqP6ZduvSUKYHI3Ojj6kJQT/+4i0PxaEQFn81vqnFoLu3KwmJdfLLNhzEevJADuF6ggRMmY0wl6g3A1Xj86iy8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357020000_e2024357020059_c2024357020059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a60983da-5fdc-499b-bd5a-72bac0bd3044', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRZEHJG77MDF0J4', 'x-amz-id-2': 'm8QMOerSmKaMZFwBYiq+j1rd/tuwPbd0ka+mGqP61XKCd7X9pbw4kOUx//aB65bSnOOLNKWZGGWOv3efwwY8DlCQOMlVwbMj', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357021000_e2024357021059_c2024357021059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:00:00 (157/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:00:00 (157/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:00:00 (157/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:00:00 (157/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (162/288): 2024-12-22T02:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (162/288): 2024-12-22T02:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3f61762d-aa43-48a7-a175-a71624264068', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:10:00 (158/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (163/288): 2024-12-22T03:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (163/288): 2024-12-22T03:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRJ39MD67MSY1X4', 'x-amz-id-2': 'WymsGbipJIPWu0Rctik0J2omr8HdtC6XzBCGRlRgKKeNkQCSERlGptmRcFAiq58p/nkuuZ9d6n6EH4DEntPtoj3IjFAzyieWfod54OQjvlo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357022000_e2024357022059_c2024357022059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0fbf65fa-fac7-4f39-b44a-6ffdfc256cac', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:20:00 (159/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (164/288): 2024-12-22T03:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (164/288): 2024-12-22T03:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'WDRYQYARDHZZ1R9K', 'x-amz-id-2': 'cl3wXpkNuUBWRVB1ncuH8Mj+UCZR3eyTCUYozw9wyA4qUhOMG0KsCdvKRImixVslnNgUfYwU9KAxSZcYkzYI4LK8ZUPQfxxKxEYkDAj8DCg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357023000_e2024357023059_c2024357023059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:30:00 (160/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ef41da41-06d6-4a1c-bd60-9ac6d42dc3a5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (165/288): 2024-12-22T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (165/288): 2024-12-22T03:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4FEGF8GSYXF9EK', 'x-amz-id-2': 'nywym+TUgJYXagYDemyace1kNtmKFqlgXr1PnFmCuLUlTZXz2spTs2VcRMt2BLGm/auWdn5lDDnX8DlKKygzQRTx+Q5uE70xCm5Phd9kNbo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357025000_e2024357025059_c2024357025059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:50:00 (162/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (166/288): 2024-12-22T03:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (166/288): 2024-12-22T03:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3f7e1b95-99f0-4dd3-a225-b61e23962fa8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G48A6AT5DZ3Y9Y7', 'x-amz-id-2': '3C3Me8rFyBcqp4XaF75T9k6NoKJW3qSNEcm/EjjZlpxAS8afiep0KtA3nQlYmFiXdontTzyG92p7WY0Ub5R85ZZ0YxdTf2ME', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357030000_e2024357030059_c2024357030059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:00:00 (163/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'41cf1f2d-0579-41be-ae67-32b4dc120b8e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G47DQW71X1WABFM', 'x-amz-id-2': 'hb9cMjsFw2q01W3i3zob0xhqFhPE+sk9EmfRtRiUVzXqA/qtIbWotVitySO1TsgyUuu7UPrOLjY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/02/OR_ABI-L1b-RadC-M6C13_G18_s2024357024000_e2024357024059_c2024357024059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T02:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (167/288): 2024-12-22T03:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (167/288): 2024-12-22T03:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e5740941-8f1d-45d1-b4af-f3acce6e17ed', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T02:40:00 (161/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (168/288): 2024-12-22T03:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (168/288): 2024-12-22T03:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G44D382SGBB213A', 'x-amz-id-2': 'JhbEHD75KVkIppnpBgervTwZPXjArC03o+N5XtDyvp/4O9LnHzGwDJX3tF+2CCTaSXWs2pUOhJp83+e4tgPd2IXZn4G4qKmAOLC71sfjvk4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357031000_e2024357031059_c2024357031059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2eb1651c-0d19-4331-b839-d502b70f2284', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:10:00 (164/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (169/288): 2024-12-22T04:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (169/288): 2024-12-22T04:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4A688P1YZYPNVS', 'x-amz-id-2': 'kvyln4r29A1NJP4mUBVmOk1V6flF/49GXqjBmszicpYcDif/6QBpaGCfzf+eo+aH8TGfJaoHleEAHmKzTMJMBl/RrjEbcGb1F9dANiKVTsw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357032000_e2024357032059_c2024357032059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7b02c1d4-c396-4b3c-bee9-54d0b3276ff6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:20:00 (165/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (170/288): 2024-12-22T04:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (170/288): 2024-12-22T04:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4E6XB4VCGQNNGJ', 'x-amz-id-2': '1qNyMOQnt9Q1udWU5PYqLo1uHeRBac48wQb1PQEp4aeqszMZntG2MZAwbgT/GhT7Rl34X8maxPh0SvLFgCCKk0qiqziUtHxXkfpcsGMxfl0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357033000_e2024357033059_c2024357033059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:30:00 (166/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8bdbc858-1404-4b57-a876-6c775972c16e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (171/288): 2024-12-22T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (171/288): 2024-12-22T04:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4DSAJ3151JTS4F', 'x-amz-id-2': '21rilFMehjPAibDWId8iaooZZjbdEU2/E+Bkq59rdInPqswRfGxeaBxj3DFkFyAbvalOmGYTT10=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357035000_e2024357035059_c2024357035059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'958d5b01-af88-4c6a-8c35-3bd7d356d287', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40VWFAZP3YDRY9', 'x-amz-id-2': 'D/S2YPfPWApdoo4dXUF9JSXFpubJlghhgy/g1bWkikfe/iiE+vgumW2a11pr6fyRRGwV3bOcmyegHwj4uclvDeaTfmcN1IcV', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/03/OR_ABI-L1b-RadC-M6C13_G18_s2024357034000_e2024357034059_c2024357034059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T03:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'65434fbe-0c66-4fc6-a746-65c682ea55b9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:50:00 (168/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (172/288): 2024-12-22T04:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (172/288): 2024-12-22T04:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T03:40:00 (167/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (173/288): 2024-12-22T04:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (173/288): 2024-12-22T04:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4ESR0SXK6FPZDQ', 'x-amz-id-2': 'QdXRDV3tjfyzMZYSKf9oi7kBRNKn06vb4uBfaQmKcL9jJBMAhoNdBIcC6LdmG2BS16rfqZopC9CBdCHw5g4FW7WSqFQ53a1cZNdt8mTEw1k=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357040000_e2024357040059_c2024357040059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:00:00 (169/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (174/288): 2024-12-22T04:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (174/288): 2024-12-22T04:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3699ed3e-957b-4a0a-b64a-95d50fefadd8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4C6R2WA3MGN7V4', 'x-amz-id-2': 'ScrALEXYUnyUEkc7eNxrYg3XRuRVYbGoDwKkBmeSnPMMVoNQfuYod49zLLDAtmDLxmOEUBhrgzDJ5y1Sm0LVeUsfE64SRSlyDjkPuo9Aafw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357041000_e2024357041059_c2024357041059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'00eb30a0-b171-40f7-b4cb-5e8185df953c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:10:00 (170/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (175/288): 2024-12-22T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (175/288): 2024-12-22T05:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4AH5EEGS7X17KY', 'x-amz-id-2': '8TnnPArvyBtjcwtXLCynvIdH1uWgaVw0AuLSBRbWotFOBA+wxRfcNv49QyEsEqlvFYJvulhAaVoSCuhMG6qX9ge8I1M6rmtKL4kKk9+ZbD8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357042000_e2024357042059_c2024357042059.nc[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:20:00 (171/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (176/288): 2024-12-22T05:10:00'[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (176/288): 2024-12-22T05:10:00'[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'974324fc-4e52-49a5-8a40-63a4aca17c79', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40FB8QQFYC43B2', 'x-amz-id-2': 'H8CSJ+Iu3MDS+tzax9niyRXm82k7fW0PLUdjehEZUpRH9dFd2UyuFmQKA9CABadFUqKIheAL+Q0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357043000_e2024357043059_c2024357043059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b9b40b19-51e3-4229-9149-e07c977d1238', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G48E4XS3KRTFFWC', 'x-amz-id-2': 'YfLPp9l+WVOXbHvHAAXl+qTaA8y2AQ+tb0PHrTWb/BHbnnPNXWmN5XHFRMG8be/R0l9ingDeOSjiqifrp3iSciptlPjZIuJB', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357044000_e2024357044059_c2024357044059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'25c7331a-f230-4fe6-881f-62b3ac952c96', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:30:00 (172/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (177/288): 2024-12-22T05:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (177/288): 2024-12-22T05:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:40:00 (173/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (178/288): 2024-12-22T05:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (178/288): 2024-12-22T05:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4CQGRFYDMF7EAD', 'x-amz-id-2': '5d28Nm9SAtwolcZU434cYdsUHMGUfE8Efcbqvig+ZBtZDRFQO1zTVeMQRMXAUjQdItNY0oX+4JfZ4PfqWREZNyyr+QHZaQTqw3YKZWs386U=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/04/OR_ABI-L1b-RadC-M6C13_G18_s2024357045000_e2024357045059_c2024357045059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T04:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T04:50:00 (174/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6cdbd09a-afa6-459e-b2a0-3103cbbb33d2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (179/288): 2024-12-22T05:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (179/288): 2024-12-22T05:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:40:00 (179/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:40:00 (179/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G43WDRGFBJ7EV6W', 'x-amz-id-2': 'VrzTAxHBBhYLBDX3mi4pls4UsJ1ybQswzLXYj2YgzLkdHsPFN4METFwWtoAYWvEdBOUqmCvqiaPLpvVxzvyTTdAdezE3I8R2uB2wqQ/7DV0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357050000_e2024357050059_c2024357050059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4bfe8204-bfc7-4746-9da4-bee881a45ee0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:00:00 (175/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (180/288): 2024-12-22T05:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (180/288): 2024-12-22T05:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G466D9EEZYTM2K9', 'x-amz-id-2': 'T6atDp6IwE0Lhb0WUFK3VhlZ8Wd0p86UN3botMPoY865m5tP1oqRWZIdIQdC6vdGSYlwbv3CFNjLWbyvaJnVcLohTvIBs28And7kqUGlruE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357051000_e2024357051059_c2024357051059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:10:00 (176/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (181/288): 2024-12-22T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (181/288): 2024-12-22T06:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bc31330a-49da-4a2a-b195-4e2f92f82c7c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4DVHDZJHBG5HXM', 'x-amz-id-2': 'EVrqhG3fpXvp/jmZSSiwyArTN4J5DpuQXd/P3OW6et+0T79ob7Zg30Iq515UkuIFWHmjId4AjQlqOGdWFJMdFaVj5JaQBYjb', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357053000_e2024357053059_c2024357053059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ac6aaa9c-82c1-4218-a881-16dfe040e9f6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G475F97W3X6SHBN', 'x-amz-id-2': 'nHXjHOOL9MJZJnNsIFrSlEGN199XdwhqmZyLWsTq+bW4toZuhp0otF2J0X6jaaW3g2xh767tGxs=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357052000_e2024357052059_c2024357052059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b4f687d5-fe9d-4cc4-8c21-de1c3914c5a9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:30:00 (178/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (182/288): 2024-12-22T06:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (182/288): 2024-12-22T06:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:20:00 (177/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (183/288): 2024-12-22T06:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (183/288): 2024-12-22T06:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4A8RZVZDSQAH55', 'x-amz-id-2': '2DYQ4zUT/ZDDttV9X9EpHrq0JzCsJRVNZHhIz+wu4fvZryhJUytvCzsJrOy9TMEAIzjnnycBShiUy+NaMWO4LZaquPneEc8viFA+fZX2+rI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357054000_e2024357054059_c2024357054059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:40:00 (179/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:40:00 (179/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:40:00 (179/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:40:00 (179/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (184/288): 2024-12-22T06:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (184/288): 2024-12-22T06:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c1e33e4d-06d3-48c0-9280-493ae7876772', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4ERMZ8B9AQAJ1H', 'x-amz-id-2': 'oAeqoI7n7Z9WaQOhCTGkXutTYr0+wuc0wLj86v4vO7wE3C25neROpBh+8VFNLMgXDo1lDNhBup9bV1DfEwSJF12uxMArRS0m38zao4i0J54=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/05/OR_ABI-L1b-RadC-M6C13_G18_s2024357055000_e2024357055059_c2024357055059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T05:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd694b790-aa6a-40ca-9499-19a3854ede85', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T05:50:00 (180/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (185/288): 2024-12-22T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (185/288): 2024-12-22T06:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40XCCEHG6CNBA2', 'x-amz-id-2': 'K1hv+DCha89Kesyc5pB454ZNvNmh9ptUcV2D07EBuZVi2LVKZzd30M3rFkl7qGXiJnTPg+mJDYCY89XhIpEZAOnpUUer9fly3LYI+Ay+q04=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357060000_e2024357060059_c2024357060059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:00:00 (181/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (186/288): 2024-12-22T06:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (186/288): 2024-12-22T06:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3ee709dd-9d80-4e4f-b3a9-af400c4c08d8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4CHMZBTGK42NX6', 'x-amz-id-2': 'ERCXj62mAXwX0fZnQXYGGxlhiRwNF2OB5n1jsoEjOjhwNdSeISBp+Qrk3j8APuVudRAz3YtCVYk4k54xaPvf9IKm3d67VdoL', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357061000_e2024357061059_c2024357061059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd6e79253-5061-4517-bfc2-9e6fa4146089', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G42NNY67Q0ANWG2', 'x-amz-id-2': 'OXKXwQPVf41A0KVqNuv45KuZ2K06gtnXtq5S9fIxhAeHr8y8GsGAHnyHaDUboT6CAxE0euIbwgA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357062000_e2024357062059_c2024357062059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'98acad9e-ea08-480a-a583-01e13f6e3ad5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:10:00 (182/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (187/288): 2024-12-22T07:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (187/288): 2024-12-22T07:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:20:00 (183/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (188/288): 2024-12-22T07:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (188/288): 2024-12-22T07:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4CXGCCH1W8PB08', 'x-amz-id-2': 'Ga7YF6kdj3AumW4q1mNwjHYXVlTccgHfcU59KtPyq0CHRuQikulMCaesePOqSs9//tIRh/1TnlPt09RSl+33r+7O2vO+Y2/Wqco8yEepfL4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357064000_e2024357064059_c2024357064059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:40:00 (185/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (189/288): 2024-12-22T07:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (189/288): 2024-12-22T07:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c230cf5e-1c38-4564-ac63-762ac650208f', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4B533W7QVFV0RH', 'x-amz-id-2': '/wXX/2Br/C8mqu69wTEEGo4+L0dWLqCP/TRQJQOKIqm0z4j8piILiC1iIes9KtjkAdIfLXQ9vhL/Ii42pLJIJuBCQUvdLZDYJy//wbEkCCo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357063000_e2024357063059_c2024357063059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:30:00 (184/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd96939da-3b71-4c7f-92f3-576644ec96af', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (190/288): 2024-12-22T07:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (190/288): 2024-12-22T07:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G46SEN5A5B1C6V3', 'x-amz-id-2': 'ZI2UJOywYOSUS5VvTt2OjpAmbRmW4P6M0LfcolIMw0T4NST4n51ZDzpx3pavKW0x6uR1CfuZfVpJW5mC6ovT4Hb/YV5YTCfE3UEbnCc9Jgo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/06/OR_ABI-L1b-RadC-M6C13_G18_s2024357065000_e2024357065059_c2024357065059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T06:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T06:50:00 (186/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'51a5e8f9-3e5c-4ed1-b254-dccc27637b37', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (191/288): 2024-12-22T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (191/288): 2024-12-22T07:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4BV557F47J4AM4', 'x-amz-id-2': '+CtMm8qYmXwyMwWQWCcuKSu6J0z6pfOqrmrCCzwvDXUiLkyuAMysHxB9Op/8atlhCJAohNSYllqBYTL+Rt5AVRMNhE/Flpc2', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357070000_e2024357070059_c2024357070059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:00:00 (187/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (192/288): 2024-12-22T07:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (192/288): 2024-12-22T07:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T07:50:00 (192/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T07:50:00 (192/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'509cc2f4-3a98-4920-b339-0e5aa2c5ae02', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G46X0YYYX4ZBK6V', 'x-amz-id-2': 'tyW7n29sAc082F4sBUXOnS3EcIVLeSKXIEhTidmrG2JP+oof3ImNINZuW21rsCT26B2cPEm4gFo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357071000_e2024357071059_c2024357071059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'cce43222-5caa-4dae-97ed-753a6a842a5a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:10:00 (188/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (193/288): 2024-12-22T08:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (193/288): 2024-12-22T08:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G407W1N3HAPPAKZ', 'x-amz-id-2': 'ea5vg4A+wFZlCWb7X86/HGdHut3VEJYWWVJePeu8uih3o+Pw67aQdh5yZ0SWfHZPLJx335hYPs6zXHTkvLXNHHr9BsLr+hwalCWOtqOg7uw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357072000_e2024357072059_c2024357072059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:20:00 (189/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e84fe549-e078-4797-afbe-7c6b1bd99018', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (194/288): 2024-12-22T08:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (194/288): 2024-12-22T08:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4FNPAEH3VK4F5M', 'x-amz-id-2': '56SaUjk7Cr+oV6AKJC593XX1AMVoYM6bp59dwJAcSrZTLF1p3/qsMM0X9QIYIKQGjNxwceBtY6DTWW2fAg5nTpHrIfoR0OHmoJoW4Dw7njI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:28 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357073000_e2024357073059_c2024357073059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:30:00 (190/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'677d9c61-5086-4753-af1e-8a4d056c13d8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (195/288): 2024-12-22T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (195/288): 2024-12-22T08:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40B646X4CXYHN9', 'x-amz-id-2': 'qNfoGMoFTRfHzpfFmQVUjsA0Rm+4CYhMOdPLANtuAMvK2pccW2G9S2xX5nB1k2ZbQZgnBttUkjf5bpoWaAnwDalbfdaRsKxv9W/2Ig6jc44=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357074000_e2024357074059_c2024357074059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:40:00 (191/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9344a226-9a1b-40ee-b1f3-3089554c7ac0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (196/288): 2024-12-22T08:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (196/288): 2024-12-22T08:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G401NQAC99DQVRW', 'x-amz-id-2': 'Jmpv1QQSBvd66Z2FWfWurqbnLtmoFaosIJaFYudje4SSYAdR0G1i5YMnHlvlB+3CXwO5Xk+WBWqRDjh3oGchzh1kIC0eH6KX', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/07/OR_ABI-L1b-RadC-M6C13_G18_s2024357075000_e2024357075059_c2024357075059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T07:50:00 (192/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T07:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T07:50:00 (192/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T07:50:00 (192/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T07:50:00 (192/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1898e2a4-2440-4995-b555-f45ed43a1063', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G41Y3WDCAXZXG6Y', 'x-amz-id-2': 'VsyScAeKhJuxo0dok+dj1PjRlKc7amgNmnoHWaS4AMEmkUOFO7zcCfA8uniE9eVaUASaO3whJ2Y=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357080000_e2024357080059_c2024357080059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (197/288): 2024-12-22T08:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (197/288): 2024-12-22T08:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bf9d8dac-c6cc-4c85-82d2-8cc14198a480', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:00:00 (193/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (198/288): 2024-12-22T08:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (198/288): 2024-12-22T08:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G46Q37EEJ8G0SK5', 'x-amz-id-2': '8rv20uoJA7qr3G/h/zwm0hH0BOzjJ+thj909P5oaBujt1GDqd9rR1RimFrOJXeD3HqXc5PvGchsqdhMVvh+fEDLN0ndzOBOzLMMk2iUOq28=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357081000_e2024357081059_c2024357081059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:10:00 (194/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8d39a3fd-979c-4e06-8379-6298dd227463', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (199/288): 2024-12-22T09:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (199/288): 2024-12-22T09:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G484N4K3W2EF2Z1', 'x-amz-id-2': 'Q/ganwLrlGtrtC7VpDgn2+l3qTfh3gdzwNC08nFybadtDq42FICDiZVgZDCjVOe1YdvPhdPDldjArgBwPrXkfNG6ZevvfbwR7K7piPXFtq0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357082000_e2024357082059_c2024357082059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:20:00 (195/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (200/288): 2024-12-22T09:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (200/288): 2024-12-22T09:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3582ed49-ec93-4e0a-8cbc-9a1563b13f08', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4C1KH0XYVC6VTD', 'x-amz-id-2': 'aHdTj5pLuTZfgPXeT/XisNJ8chfgaf65+JMVZaeH4xNiss27Vo92PbGR65suH3Wa9ZtHvLqG8ka2+xyxyiAsw7FIU24WyDqoPz5ZMPkRN28=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357083000_e2024357083059_c2024357083059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'846786ff-584d-491c-91f1-223d67ed2847', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:30:00 (196/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (201/288): 2024-12-22T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (201/288): 2024-12-22T09:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4A505TRFN9SNGJ', 'x-amz-id-2': 'TBLPpwo2c5cyLV+Xy6O1E3MkeI1MvAM8H1zBwoc2C3E2/6CLFM+SfdIeaxcFrmp+QbN87RWs/9WzeIRxUzaWacv+MQnk0aQr', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357084000_e2024357084059_c2024357084059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:40:00 (197/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (202/288): 2024-12-22T09:30:00'[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (202/288): 2024-12-22T09:30:00'[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'014fd428-8913-4c5f-b67a-db9c92b76d5a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G429WAHHKZAA5RM', 'x-amz-id-2': 'yml8i78sKZ3fuKuCtRuvIUrzGFbselWe0SYX84lWeMbq8oYnaZA6jOLll8j67uvpoCLp+RTrI/8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/08/OR_ABI-L1b-RadC-M6C13_G18_s2024357085000_e2024357085059_c2024357085059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T08:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T08:50:00 (198/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (203/288): 2024-12-22T09:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (203/288): 2024-12-22T09:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'51f522ed-7d27-4e83-ae9e-98333e8e8943', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4ESTXMZKZMR5TN', 'x-amz-id-2': 'VtgOD+ZBex0NvEqKIvbLR3ijwblhNfPKVZ6GxXWYYN27ws0ZTpJPxTCxMyNzDLcRD63W7wWtrlHtKm0meJ9rp7q5tsTwAq5xrazDtcoblc8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357090000_e2024357090059_c2024357090059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:00:00 (199/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (204/288): 2024-12-22T09:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (204/288): 2024-12-22T09:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5cb37f88-10de-4714-9861-a64c8bd359ef', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G47ZGQSZMEWGY5G', 'x-amz-id-2': 'VoToFNMJZdBXfGyqTkLpWinOncvmo9kskJlEzXkf5FTxkXCJxtshBVJ7bY040lSZpaIZbVqSjajDI72EnoRGnDdDA/m9YvaMUPpBWkKbDDI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357092000_e2024357092059_c2024357092059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:20:00 (201/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'174defef-4b07-4e95-b744-f09fc1e76b72', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4BMVKHCQN3JGC6', 'x-amz-id-2': 'EihaHFizoYMn83akzGBHY+Nu7YheFYWiaz9nUjgfYzAlpzfKmWSMzkLqaXetMzStUJpQqzoTA3WcAKL4vJ18MMLiD4OOMCUeIoK+TMOGY4U=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357091000_e2024357091059_c2024357091059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (205/288): 2024-12-22T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (205/288): 2024-12-22T10:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'05a3ec6e-bd0b-4841-9f65-4e424a7a58ac', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:10:00 (200/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (206/288): 2024-12-22T10:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (206/288): 2024-12-22T10:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4EX6BDDXZFXXD0', 'x-amz-id-2': 'XzDJnDgMK1CTb5XlkmOa1pUzl8DRfi5BIxrozFp9UtgIAXVLJvgOOT+WnQ0LV6mXs39IUI83xDAii7ofyZFKVBCAHlZMREsJ', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357093000_e2024357093059_c2024357093059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:30:00 (202/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b4289c2c-e061-4934-9192-fe1504bb0675', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (207/288): 2024-12-22T10:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (207/288): 2024-12-22T10:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40JAB5MEV439QS', 'x-amz-id-2': '5c50b4oHyixwuLBbdMUDAAs0BMtohWk/Wwyc4b5S+hPfgbm4ZUiI5/SJMf5D5GtDbD3gJadl2T0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357094000_e2024357094059_c2024357094059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'71221b2c-5870-4bc7-90aa-c4b990085964', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:40:00 (203/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (208/288): 2024-12-22T10:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (208/288): 2024-12-22T10:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40BP8YK62S2178', 'x-amz-id-2': 'SxYELEwkfZjqYPwMFt+4Ick20d9qJPcxhHd7h9l9QZH09ptMzdn6XFEBtwD0MJrfkfaXcCtHyrJu38bsoAfJef98LGAvUCYs1bar2pcGlUI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/09/OR_ABI-L1b-RadC-M6C13_G18_s2024357095000_e2024357095059_c2024357095059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T09:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T09:50:00 (204/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'073d0ddb-0788-4bc0-84d5-438774dcd488', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (209/288): 2024-12-22T10:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (209/288): 2024-12-22T10:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G44AB5X9461RC62', 'x-amz-id-2': '6Ojr+WLVs8xEHQfhjRw8Sd87dVCHojqWfO9I3c3NqoeM0ED+FBMX/7j4PzmurImSSKtS18eOVFhx7MbJouCozIE7Zu3zqTdnBQg9PUJmAWo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357100000_e2024357100059_c2024357100059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:00:00 (205/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'132d6b17-02e4-4d5a-b6f1-59380ae487de', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (210/288): 2024-12-22T10:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (210/288): 2024-12-22T10:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G49Y2WEJY36BQBB', 'x-amz-id-2': 'JKHIVU/O7PavJpGRX9hzEAa6pNzV0bymJIVSBrjfyHeUnLMFbo8dk4P2PmP8SI2cYs1RmtA/qQ9amHMzlPOd5U58X65QnDmWKUBzJEWAKZA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357101000_e2024357101059_c2024357101059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'81c5f808-c7d5-4a2c-b520-9c24e3fd75f0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:10:00 (206/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (211/288): 2024-12-22T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (211/288): 2024-12-22T11:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G43259YP57JHZ9B', 'x-amz-id-2': 'Suea1SiYNNYu/dYLaWATLNO8gfR/LBL3HJpMQmypWHj/Rk0IF/b1nq27DIFUnRVxY+VcSBNvxRe1xzDARqgyXzANXvqgNlEY', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357102000_e2024357102059_c2024357102059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:20:00 (207/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'34a91b4e-8e30-4e2a-9000-6b63602be31d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G44DAR616JBBA9F', 'x-amz-id-2': '/CU+ZFAFtIa79Vl6KWXQIXoHeWSso9Wm2wFnMlxQfPx1XcxP5dlMBXbFMtJYxvhAUfurja1HxTg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357103000_e2024357103059_c2024357103059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (212/288): 2024-12-22T11:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (212/288): 2024-12-22T11:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2d505d7b-b4ae-47a2-a5f4-fcc7ca9da689', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:30:00 (208/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (213/288): 2024-12-22T11:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (213/288): 2024-12-22T11:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G40NADMABHHB1AD', 'x-amz-id-2': 'phDSRZcE9jtNq5nj/0ruvfZmrbuxUFXj1mtCOGIOGcWfZthoV8Xfh6xgbUxIp+SFktY2XJVjwbR0sHY0mc00Cad/KeFyP/DliuU2IPDX5Yo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357104000_e2024357104059_c2024357104059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:40:00 (209/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (214/288): 2024-12-22T11:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (214/288): 2024-12-22T11:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'db6e48a6-1f36-48c0-ac24-51a1c68ae15e', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4ETT1M0D337622', 'x-amz-id-2': 'N5JgXQHuUPVAibHE8yciQQjPDPPji3wwQtXFaDS9IbZQovbgWMTLFuKWSMM0NrZGDDMRTfC1B0ixbsbotP79cflouml6rEM5PLJzoaxUrzU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/10/OR_ABI-L1b-RadC-M6C13_G18_s2024357105000_e2024357105059_c2024357105059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T10:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6b4759dc-cf3d-4c9c-bbfa-31bfef631920', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T10:50:00 (210/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (215/288): 2024-12-22T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (215/288): 2024-12-22T11:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G46RGP8WZVKVQ7S', 'x-amz-id-2': '4WBpel5rRUGkkqR1bHocaZDpS8j3mtTIWb7+TYkmmmn5kz4AVdvaQFWuZDhc2QWZvnJ/io/fK+txxdjKSk0Twb3uCkcZLAxu9k4fFPmyyIQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357110000_e2024357110059_c2024357110059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3302cee2-05f4-4295-bd78-4cdb5855b033', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:00:00 (211/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (216/288): 2024-12-22T11:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (216/288): 2024-12-22T11:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4D7WBVD574D95F', 'x-amz-id-2': 'cSV+rVlG8jwhAksrrGnGoeQytd89gpcn0txsgbEeZqQQUVxIM2W8Xxv5SudxgPLdXz8TZkDS0gg=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357112000_e2024357112059_c2024357112059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:20:00 (213/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'49c73b62-c858-40b3-9dec-9eb09980d380', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (217/288): 2024-12-22T12:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (217/288): 2024-12-22T12:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '5G4459FEMT1XMRP0', 'x-amz-id-2': 'H/e4Csk6LOhOrJhXiXBmAbSPhVSfIqNcBNAsf5PggbW3oMqkESXYHAjJjpq7d8fd0QdcalZABHqNSF6Ou9a0jHs95sYSoOmp', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357111000_e2024357111059_c2024357111059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'07d4ea28-2d34-4c2a-b21d-dea846aa80d5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:10:00 (212/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (218/288): 2024-12-22T12:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (218/288): 2024-12-22T12:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5A1EEJN9F0G8GR', 'x-amz-id-2': 'V5XfQpQdAJIAUBaVFk1P6FB4hEP9cJ0Yqae4GPJdYmFvavk72ht0x+MNsHyKYmn+xenVhYYH1Ta53X+tNxWHNevTVXvv9YDzWxqWsLUvY8Y=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357114000_e2024357114059_c2024357114059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:40:00 (215/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5f1e756b-adf6-4dc3-9705-7e5b601cd2c8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P534JQ9JT8M7TX1', 'x-amz-id-2': 'MEdnWbuvLljxDAS+FdBD01o/oEpiNUV65mS/CUeUMuEDW1JTKNGudfUKD68I6v/QocR52XH5rJfaxKFN78ksyDCZKVLWnFBmEx7FlF5UiWI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357113000_e2024357113059_c2024357113059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (219/288): 2024-12-22T12:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (219/288): 2024-12-22T12:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2f8baf73-84dc-49e0-b0ed-9773e44bba25', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:30:00 (214/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (220/288): 2024-12-22T12:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (220/288): 2024-12-22T12:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5FNZ7X7YPV56Y4', 'x-amz-id-2': 'cgEWcvXF0i7g7BQg/9sBk1RRtVgPZR8Xd093Elor06r4ZnO8SkOhL1/d2QrD/TmADXyBmi72bO2Pz5xg3+2kuDjDlhqGubTgb9IlpOAhOlQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/11/OR_ABI-L1b-RadC-M6C13_G18_s2024357115000_e2024357115059_c2024357115059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T11:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T11:50:00 (216/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7c225e78-c451-4b16-96a4-eac9f14c90d0', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (221/288): 2024-12-22T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (221/288): 2024-12-22T12:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5ER8WJ7JMDXWHP', 'x-amz-id-2': '0Qhs+aRzb5IxtfpQvtlYzAwkOmt6flAf0pHlebGgcw6KKwH3BgaxxCgBIfdvSJTFQ2cmIgaBS7w=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357120000_e2024357120059_c2024357120059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'73244fe6-7e51-481f-a14f-7730b42de381', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:00:00 (217/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (222/288): 2024-12-22T12:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (222/288): 2024-12-22T12:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5DH5SQ8BF1BDRZ', 'x-amz-id-2': 'UJquvIv9Q4wOVFEjJ7uu+16fMJ8DsTCEAW7nEfd6s+2zagsuAl5tkRkT4NM3IAPsI+C0xjPE+17hP1Pd5xxLzK31CoIJeSuM', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357121000_e2024357121059_c2024357121059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'12400cc2-0a24-42af-a702-8e7abecdbfb7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:10:00 (218/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (223/288): 2024-12-22T13:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (223/288): 2024-12-22T13:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P56T8AA202B3K35', 'x-amz-id-2': 'ChsDzf9mNesShE7iknCWZRcv15i3d4OLJn4597q5RIhlDRSNJFrdcXl8mdV6y2cj3+WF2DxSdj6EGGloh3N/gXzPjcZE/mRbgwiXq8b/0Qk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357122000_e2024357122059_c2024357122059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:20:00 (219/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8d95fdde-d91f-4c61-b50d-1bc14c71a6fa', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5943EJMK5GASPH', 'x-amz-id-2': 'PIHHT3WC7BGobkGDrglQ7dVPv+Kz9bQvTYQZlqnRlcRIfDC1FLxuh29yLUtyHmxXXhyb8sHzYA7kkHh9XRh/T4m7e2tzAxvyJF/BED0Fer0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357123000_e2024357123059_c2024357123059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (224/288): 2024-12-22T13:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (224/288): 2024-12-22T13:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1bf987c0-49bf-4b13-ba68-588c6d57eb43', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:30:00 (220/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (225/288): 2024-12-22T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (225/288): 2024-12-22T13:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BYZRAPDAX21NC', 'x-amz-id-2': 'hnms/qCkIY/YqOtEF2kKo/tm1UOErZ66VAkX7DSiotNIO3pXUGbpJqJojuiUEreJNBg4z+SkdgVLWNvXZIlfi4tmSuhichm4bSvDy+IFdDo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357124000_e2024357124059_c2024357124059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:40:00 (221/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd8530db2-6376-4aa1-a54c-6a8cac7a060c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (226/288): 2024-12-22T13:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (226/288): 2024-12-22T13:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5CPKKKD7F3C8PK', 'x-amz-id-2': 'DlIGfAFvYD8Pu6Qe1yL4YgtxraBjd/NLfycgulwq4f+6Rc/c+50GkdqFPA3tLGaIiriCurBOpb8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/12/OR_ABI-L1b-RadC-M6C13_G18_s2024357125000_e2024357125059_c2024357125059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T12:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T12:50:00 (222/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8c34057f-1b90-488c-b05c-4f82f863dca8', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (227/288): 2024-12-22T13:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (227/288): 2024-12-22T13:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P51QYZYW2FF3X6W', 'x-amz-id-2': 'UkJk57ZNEsM3292ZxWewwIBeg3HVfUKW6Y3dl9CXcdLWgioMsbsiXjSa04R4qMia/0JKsoGa1UWga05xZE5srUDZ1Kv+Z57n', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357130000_e2024357130059_c2024357130059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'36212039-b9de-4225-a112-114f96a836f5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:00:00 (223/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (228/288): 2024-12-22T13:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (228/288): 2024-12-22T13:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5355QKN61PP6RS', 'x-amz-id-2': 'JJmOfaIzFivMS3ZXRp7vAoAX5mCwvwPYX+Q5kIYxJeG+PV+ABRGX9C2JjePkpkvv0j0k/CTUptxUhXCAYU7qNVgm/6881klliHfLpC4wASE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357131000_e2024357131059_c2024357131059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:10:00 (224/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'dae03af8-c913-4689-b220-281b2b1a6997', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (229/288): 2024-12-22T14:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (229/288): 2024-12-22T14:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5AZMBTQJZPFJZ7', 'x-amz-id-2': 'Dhh+BFlT/l6TbQaM1APU9uEBomzRKqLnEOxR9/wwfjtbaQJ7sPaypwWa2gUcY4kNQSDeJbYeyt37rBpkg2CktjqPKUu66S/AlM9LfSdq14w=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357132000_e2024357132059_c2024357132059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:20:00 (225/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (230/288): 2024-12-22T14:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (230/288): 2024-12-22T14:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bb82162b-e845-4916-97dc-dd834fc334d6', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5CX3HM8CTSFHEH', 'x-amz-id-2': 'VIFGwCynq7q1o1DnrAFpQtOBZFY4vpGo36CtlmBEq24azGB2vtzfiSyLhhdG06Lykm1jQZrSkmw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357134000_e2024357134059_c2024357134059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'ae2fcde9-05f7-4273-8ca3-a6e6044c7919', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P546Z9Q0ZT3AEHS', 'x-amz-id-2': 'wuBF8iTt4WVLjzX6zJhNAiCBEKWtbPbGQt1i22BHEoa5Dmf+uNDepLMGV/QEjxnToIjsft90VeRxjYcRFvo78iw64HsS3OT8xeX3ux42dG4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357133000_e2024357133059_c2024357133059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:40:00 (227/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'66b9abe5-d717-460b-9bc0-161b6117b169', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (231/288): 2024-12-22T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (231/288): 2024-12-22T14:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:30:00 (226/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (232/288): 2024-12-22T14:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (232/288): 2024-12-22T14:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P56MX5W3YYMR4YF', 'x-amz-id-2': '7U0/Q2hQOFi2KizC6W9FYmnJKDUl9MF2O2ELVTNGqW+ge9s0SydAORnLAldPu0DY/bN5LfU8pjdmTWnaLdXFgDbMJzR0L7YtQas96Xv82JQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357140000_e2024357140059_c2024357140059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:00:00 (229/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0f4d8e51-e629-466f-b226-fcf44da71fde', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (233/288): 2024-12-22T14:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (233/288): 2024-12-22T14:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P51QJ238PME3R4N', 'x-amz-id-2': '1q+cQe8j8avLFnHOjg3jWWWjnjw7unjRjb3WkcbX3c1g+eD0Db/ivqySI8flXt5C3fzzX7h+y49c6x4DZF1cb12aALHCUG8NatGgAksG4XQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357141000_e2024357141059_c2024357141059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0ec023bf-d757-4a15-a434-25ce9bda515d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:10:00 (230/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (234/288): 2024-12-22T14:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (234/288): 2024-12-22T14:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P52SXBC0X6TVSY6', 'x-amz-id-2': 'j4mouCuBcgaDZpHhUi2csQ0Ir2oVL4DtXglpR32zMoPG91b0q/GpU5jeEAhOjlNsGfeO4x1dQEE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357142000_e2024357142059_c2024357142059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:20:00 (231/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'499299bc-3a7a-4ccf-bd0c-83c8d777da1b', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (235/288): 2024-12-22T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (235/288): 2024-12-22T15:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P59XA2E1NEYPVC9', 'x-amz-id-2': 'jNWk+scNwrTsFojbobxTjN+39Pgu6zvGX1Ca+8R4jB8mJzMrgWvSIBfVu5cmUvTS0JhvJbi+9+6E77x1m4ydipJPTWyv8kHVtyf+WiGIlZs=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357143000_e2024357143059_c2024357143059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:30:00 (232/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'63a56a3c-2536-4393-b7f8-3ae675ae4fd4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (236/288): 2024-12-22T15:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (236/288): 2024-12-22T15:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BB4Y2DM0D4AVM', 'x-amz-id-2': 'q9J6TBqjoZynjBoyMQ0BxYVMNMNtRwquWu3wHb1sccqa4H+K2CNSFQ4pM6EECBt1IRBaoTfx87ElTadbkxsEkj3IhLN1QtFRRRF0448SvI0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357144000_e2024357144059_c2024357144059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:40:00 (233/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3189f7f5-7299-4114-b93a-9c01119b30d3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (237/288): 2024-12-22T15:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (237/288): 2024-12-22T15:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P521JBZM185Y08R', 'x-amz-id-2': 'hQaqJqNq/k4Sv9WwDQx6UB+zV0OqCBOm3o6OdMqe0sx3UjTFwM8aj99b2J2psYhfok4K/4gQByCUA3xcSquQEgeUUE938dvLEhQa5b8/DP4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/14/OR_ABI-L1b-RadC-M6C13_G18_s2024357145000_e2024357145059_c2024357145059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T14:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'66ef5564-194f-432b-b608-d8853b626287', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T14:50:00 (234/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (238/288): 2024-12-22T15:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (238/288): 2024-12-22T15:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BN1T25AF35JJN', 'x-amz-id-2': 'RTRNR0ylA72l1T7Jyu4nfcbx6w2L/kPw/YR8Z/4Ivo/kPvch9L/oqujqgW6Db4E2NmHHUhKS8AI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357150000_e2024357150059_c2024357150059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:00:00 (235/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (239/288): 2024-12-22T15:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (239/288): 2024-12-22T15:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5f757aae-da7b-4323-8247-a16dcb522391', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BNHG5P4P5QB13', 'x-amz-id-2': 'oIs4ChkSdDFYYgdlMaNimQHxNYVNbtzXbfxoGaUZDC/2BEpHF5DKB/H297eyd0T/xPFm891CFBIbaFLdx21VHMNNsOf6c3OMGAYUtgQZHhQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357151000_e2024357151059_c2024357151059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:10:00 (236/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b6b61a1b-785e-4301-8736-a6c9e2079284', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (240/288): 2024-12-22T15:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (240/288): 2024-12-22T15:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P50DRMRFGV3C7D1', 'x-amz-id-2': 'OLzKAODD1oqRef3/qIL5fDPHOHevbbtKp3ftN8GUtRsruxBz3rv7pVEltJv9Qo1aZI5PX4KoH2bOokzpCl+y7HbG/LcatkNWbbgZdtZEaxU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357152000_e2024357152059_c2024357152059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:20:00 (237/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2d3b21a4-3306-4c2a-be26-36cd497379c9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (241/288): 2024-12-22T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (241/288): 2024-12-22T16:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P59WMJSZ12RT6CP', 'x-amz-id-2': 'Asu56haSFxcKzjtGQjs2wkx/FXgYdsZk0XENEXGhS8W2nDJ3SJ876Ia57bB3xt9K0rtj7uk0yOqcjCg5oFdiqjlsfhkM6MaY0cwfyb5f8Dw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357153000_e2024357153059_c2024357153059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:30:00 (238/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (242/288): 2024-12-22T16:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (242/288): 2024-12-22T16:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'194424b1-403f-4cc2-9610-7d4be9c26547', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P51QMH7D1BFG8GB', 'x-amz-id-2': '82yKvwdzt46Ra2CvEwhP29f69EeG2QU04ipgVgrI40UNzwERdtRngZOn4K7J6dLDINgKpvdIDu4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357154000_e2024357154059_c2024357154059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2d09a8fd-8a8e-4c60-8a79-76ac2fca0275', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:40:00 (239/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (243/288): 2024-12-22T16:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (243/288): 2024-12-22T16:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P590J2C8KWRCGVC', 'x-amz-id-2': 'lT2ziEC7XblreCp6oH00zKkSbchCJbivuduI7uY24CRkiejSwcrXdR5c9sT+4zV/ogCXyJc79dzJBtCiQ6IM8PveJCDDMMrh', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/13/OR_ABI-L1b-RadC-M6C13_G18_s2024357135000_e2024357135059_c2024357135059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T13:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T13:50:00 (228/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (244/288): 2024-12-22T16:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (244/288): 2024-12-22T16:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e42b065d-1c68-4db8-bf8b-2fa61a7c34bf', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:30:00 (244/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:30:00 (244/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P57577SA339TSPX', 'x-amz-id-2': 'iXU68YwTWZvSW7p/vf7iGW4UgQ43bBHJsbi4ivpXl55kwAZwK5IBHY7KZeJ0kgJJfeqEb6z9mIZVuPX57+sXZIAHJuu2hr6OfmMphNC3mnI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/15/OR_ABI-L1b-RadC-M6C13_G18_s2024357155000_e2024357155059_c2024357155059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T15:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd907782b-32ec-47db-b254-d3dacc121c1a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T15:50:00 (240/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (245/288): 2024-12-22T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (245/288): 2024-12-22T16:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P57A2JCTP2C05G2', 'x-amz-id-2': 'tRnioUpIThLPYg0Xlxj6zUQbnKbuYOeO+jsn34b4K0882J01lw7kZxMcV1/YZ5GN3wQdGSUqnOHXZCB/9sedIFzurrNibDV+3+yTdWLUWY4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357160000_e2024357160059_c2024357160059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:00:00 (241/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (246/288): 2024-12-22T16:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (246/288): 2024-12-22T16:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'b99103aa-7366-4051-b6cb-c6b2a9d95ce4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BJD1XBKJGP91B', 'x-amz-id-2': 'g0UaWOpoGOAAd6TY29wsial/VyXFdyTbIiZTtJmzOPLK3VxFdCmhcOI1cXb21PedEtVTF1v/eV8t5xJgI9f2LeZeLW0p1Ip2ORSXuBRAtjk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357161000_e2024357161059_c2024357161059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'a3c61982-11a2-4c67-bcc1-c65eb71b9ed9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5087H914NG0P2S', 'x-amz-id-2': 'WcfGMJFqsswYgljDKh5NkCe9c13MZ4jaZukbvTdT+WvmSjCKP1NyyA9DKZ5YgS0tjZdBY6+fhz4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357162000_e2024357162059_c2024357162059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'937e1abe-ccc0-490b-b340-68eabfc339ec', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:10:00 (242/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (247/288): 2024-12-22T17:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (247/288): 2024-12-22T17:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:20:00 (243/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (248/288): 2024-12-22T17:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (248/288): 2024-12-22T17:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P56YNFWH4T3P0FA', 'x-amz-id-2': 'CySqyfZmXD+IgdZs/cS2BimwhogvUvRCh//UQwJS/p92Eqd0jTniQdJj+ooySSZnkujZtUw8KAav907JMz+hgpyfJYK0u+Pn', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357163000_e2024357163059_c2024357163059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:30:00 (244/288)'[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:30:00 (244/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:30:00 (244/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:30:00 (244/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (249/288): 2024-12-22T17:20:00'[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (249/288): 2024-12-22T17:20:00'[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'20914f30-f864-496c-9dbe-6027500e1a60', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P532N9R9ETX5GS2', 'x-amz-id-2': '3Tq9eRGp8NgmvbT2Z0bPy4tFbUYd06vMnuvnPDs4FJ5SUsa8fFfGzI1v/vSUgIkl/YQlASPc7o91CAOECRDoEpUMyZco57ayum13lXAtpIA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:29 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357164000_e2024357164059_c2024357164059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'6380941d-fae4-4eff-8bf5-f75b8fa395af', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:40:00 (245/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (250/288): 2024-12-22T17:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (250/288): 2024-12-22T17:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P54CP8A8PPGP5KM', 'x-amz-id-2': 'YXgZIDrqzbwo5hSU2AiiGRnN4A/F7Tt/ns++5mgRIVMpEYM2r/iXraErrCTgzTe8IZ2sbMmllqFYb+Ut94G4MVPxxciNQ0DN8BHirmF9k8Y=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/16/OR_ABI-L1b-RadC-M6C13_G18_s2024357165000_e2024357165059_c2024357165059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T16:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T16:50:00 (246/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0ba15c70-875c-4154-ad13-90adc348b091', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (251/288): 2024-12-22T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (251/288): 2024-12-22T17:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P52YNEM75B03WQQ', 'x-amz-id-2': 'lPuZhbTep5+2DsguSEXhoyxeZPMKRHeiY79duGtw4ThkOv7t7LVqFw+qtHe/JvrMQnc7H7Svomo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357171000_e2024357171059_c2024357171059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:10:00 (248/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'89a6660b-726d-477b-bc06-5bf9efea7d85', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (252/288): 2024-12-22T17:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (252/288): 2024-12-22T17:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BSAAKS4BFYGNY', 'x-amz-id-2': '78liJ3S5UL1UvpeIlFB4LfT1elIBSLQn4ayHXy/neub8IGGcHPofYpm5DT8ZymIeBPmIv+XUy+9f/cDz3DMLiZzroYG7iee9PQcWu7Nk8vo=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357170000_e2024357170059_c2024357170059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'36c26b0a-d529-451b-9e64-423a34bcfee2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:00:00 (247/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (253/288): 2024-12-22T18:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (253/288): 2024-12-22T18:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P58PPRNZBR7748T', 'x-amz-id-2': 'P801TQ4GYo2cSzbGr9ldhFfgtw/zcVDsqlPRHSxGO2NUQa7fDBqfeQ3UdKSlq+0b5+01gWNmPrWO6l155L/xJqftSoUCzbiy', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357172000_e2024357172059_c2024357172059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:20:00 (249/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9c866d0b-3fa9-4084-9ff0-07de6e33de0c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (254/288): 2024-12-22T18:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (254/288): 2024-12-22T18:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5A1JYF508VNX4C', 'x-amz-id-2': '6djBfBecft3oWhfLuNDYl5MD2M2ImLCF+ncIq/Tm/j5TDZEspUpILEfcPB5OA8TfMLixvrncP17hVWV+ppdxKqkytZDyRJ93Omb/uAHGTm0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357174000_e2024357174059_c2024357174059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:40:00 (251/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'7b695d40-25ea-4136-a0cd-09b0decc65d2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5EMVNC8F4F1WDP', 'x-amz-id-2': '+GncvUbPKq9nmDCBEA+mh40SdqgjtY7lXlq2lo9SsmFh5mxS/ODUjvBXar5sAHLp9JXRDjODD+F9Vv13rDrl61si4JXJSvaaoo1Hxeq+CTY=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357173000_e2024357173059_c2024357173059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (255/288): 2024-12-22T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (255/288): 2024-12-22T18:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9fcb7904-cd14-42ac-b952-70365a10e126', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:30:00 (250/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (256/288): 2024-12-22T18:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (256/288): 2024-12-22T18:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P53NHKFCSXXMQ13', 'x-amz-id-2': 'WVB9OyAPr6fJGQtstsxgyL4NgSYQIu38oKFLEfyxeZ3OFGqzO3ASJIrFstDhojlvNvnAMEAeJ7bs/DFYWzHhRvqhWEpyBpu6qT6MiErX5gM=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357180000_e2024357180059_c2024357180059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:00:00 (253/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'92342218-5762-4be1-a194-01ef552734d7', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (257/288): 2024-12-22T18:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (257/288): 2024-12-22T18:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P577D34X6SZ3MNW', 'x-amz-id-2': 'fF+OAzIIqqosvMkpo2t+U4zbrxhno/LrTEATHvyAo6l+oCKyJDdEnstV3w36pshLN2SRXpuDugU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/17/OR_ABI-L1b-RadC-M6C13_G18_s2024357175000_e2024357175059_c2024357175059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T17:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'22401ade-49d0-47bb-afd1-17ac1cb111ab', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T17:50:00 (252/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (258/288): 2024-12-22T18:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (258/288): 2024-12-22T18:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P58ZN9KW2R2VTGY', 'x-amz-id-2': 'EWrFlnmp7FqupyTdTy4bnAMBvZ6PNWz9plMTeLDJUy2njtdwacHevXTfBecnYjLU14hqknPRB2UfmWy97Yk2f92lY1L4fljw', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357181000_e2024357181059_c2024357181059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:10:00 (254/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'c850b95b-1a4b-4ac5-9a1a-e0e542c83687', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (259/288): 2024-12-22T19:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (259/288): 2024-12-22T19:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P52E7D1ABHJVPRY', 'x-amz-id-2': 'BokN6WzkkmpjPk719rLuoY+lbZH+F51xpFfYgWVtvrRAqI+r2aqCq+orRhh1O7Lbqtbs2YzRvkyteKIKefguYH4VuYOgn31CWuOx87e1W3o=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357182000_e2024357182059_c2024357182059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:20:00 (255/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'fbb36be5-de7d-494c-ad31-59e41e49138c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (260/288): 2024-12-22T19:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (260/288): 2024-12-22T19:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5DYVKJRHKAJATM', 'x-amz-id-2': 'w6UoJQRIgU9OH1aUFDGZOiGJbl7iKwf7G4fIyOpO6Ht3AMn1FYb0Oki7SAZlc0Ziu70r9c6GKS4yFP11s5eW/rSZRxbgAzE9y0pa7eWoaA4=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357183000_e2024357183059_c2024357183059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:30:00 (256/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (261/288): 2024-12-22T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (261/288): 2024-12-22T19:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'17df7fa4-c340-4020-bc3b-ce3321c7143a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P592D9AK3C0GV57', 'x-amz-id-2': '73FWMGAqWUliwBa6pgkjBs7DSZNedah/uiP3ET9NckrMm/UGT6AO5KLh0WMvoMEDTKjPv1pQH1FSmD4JGhfPmzM1pjzxLXO3f2atgTbTRe8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357184000_e2024357184059_c2024357184059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:40:00 (257/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'522003ad-d993-4c42-9e7f-819861aef922', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (262/288): 2024-12-22T19:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (262/288): 2024-12-22T19:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P5BR2EQA5J89ZDS', 'x-amz-id-2': 'ePRb+BzYo3IMTB29TIFA95Wx56biBVSLrWYKGzjXEJkFkSMS2hTyLkvf+yldxEYbGUVrEov0dec=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/18/OR_ABI-L1b-RadC-M6C13_G18_s2024357185000_e2024357185059_c2024357185059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T18:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T18:50:00 (258/288)'[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'61de7b47-4cd1-408d-a8eb-b5705a87c4a9', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (263/288): 2024-12-22T19:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (263/288): 2024-12-22T19:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P56FF9C2C4RYF84', 'x-amz-id-2': 'GB9JxIq6fkAmJtmjI7MfjZwlubm+1UGU+nqC03BqXEKXqwDCket+FeokdYrioEXh5y1Jp/fo4r0SiQtqxLj3m1VndkeJAcnY', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357190000_e2024357190059_c2024357190059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'4ffe7947-8611-4ba5-bb4f-05cbbd55daca', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:00:00 (259/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (264/288): 2024-12-22T19:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (264/288): 2024-12-22T19:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P54RAQBVCS93C6G', 'x-amz-id-2': '4rqUXiZydWionp3aAM+5Vc7vcupdK9WuKNyP8syZhSGx7UjWmIa6TgZV304OmM+W4fJ1PrpbsKh4Kic6+y2UvDj3qQdsD8hTMq4meC2+znw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357191000_e2024357191059_c2024357191059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:10:00 (260/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1cb95ea1-95f9-4601-bbeb-4114bf327579', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (265/288): 2024-12-22T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (265/288): 2024-12-22T20:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': '0P51ZGY1Z986HHGS', 'x-amz-id-2': 's4L1JnkQLDaPXTFgUyXZ5EcBoOY+E2vBH4SLB8uhvslWrm03lXh0Q79J7hy8/bjTvSa5BsvkXfHZVZOSYRnHh8dEsJmKuhduZ6ZUMi5h26Q=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357192000_e2024357192059_c2024357192059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:20:00 (261/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'021b8c49-bd38-457c-8933-149b132a5657', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (266/288): 2024-12-22T20:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (266/288): 2024-12-22T20:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8G48664SK1XA1R', 'x-amz-id-2': 'YF+vjOROHiJRY19TMMnZAocezq6GeMur9siPjO224QiAbOlfoRSAiVyXgn8gg9+wfz54D5ub1njgrDaKeGq/MNLy3t/MrjvTsYMXcW9C2+8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357193000_e2024357193059_c2024357193059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:30:00 (262/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'53618827-3c39-4b4d-a11e-ca0cd2ba09b4', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (267/288): 2024-12-22T20:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (267/288): 2024-12-22T20:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8W1ES1P471KJPV', 'x-amz-id-2': 'jbVF1Ke6zYQdryTG/mO0Xj3W3yoH003EmvTaFaipKzcuHt/PtN7+vOe8W6W3hF1+1XhcWKvLHb0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357194000_e2024357194059_c2024357194059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:40:00 (263/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'3ab97af1-2833-47c1-b932-a89d7c134316', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (268/288): 2024-12-22T20:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (268/288): 2024-12-22T20:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8N30RHQH9CB4P5', 'x-amz-id-2': 'Q9uN/r5SS8qNnG42zTuglUdUelFoFODORIo2jxxZx9j5Gt5U3WZCVNS8/0tDlfNrP1tzgtOMvsbG7pWIjI37b/7yZzikerl0', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/19/OR_ABI-L1b-RadC-M6C13_G18_s2024357195000_e2024357195059_c2024357195059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T19:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'62c4a073-2a51-490b-b881-e56c9769403c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T19:50:00 (264/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (269/288): 2024-12-22T20:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (269/288): 2024-12-22T20:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8TBVA09MH8J47R', 'x-amz-id-2': 'Xjm/kd7ar17wmy0EUSWPcINhm9CdnMMEi8RUiyNX0XoUGqqltCrdX/nCp5NF9IdtvNJrsCjy5b4UR/a3BPN4O+bMqlSdqScEvWd/i054iC8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357200000_e2024357200059_c2024357200059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:00:00 (265/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'e85f8765-df31-4e9e-b49f-e745e6c91690', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (270/288): 2024-12-22T20:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (270/288): 2024-12-22T20:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8XZQQMD9E7WWE2', 'x-amz-id-2': 'RC5wEbdhd521G2IKtQ0Gk2C3Ob9eRk7kiQapDuGH81YJwY/czC6maHhKV8mFYilNd0hwzKdZX2DdfBIC6LJaSu1x8jxC83tvcBKnuTpJ3js=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357201000_e2024357201059_c2024357201059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:10:00 (266/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd3a92c1b-139f-4812-82dc-43f374861ea1', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (271/288): 2024-12-22T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (271/288): 2024-12-22T21:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8Q0J0DDJXQ97NW', 'x-amz-id-2': 'XUof3dSQTwzcBnipW6gDbFDvco9hTMUl79zLwtb+F8csRD1CI4K5aV7r9V3/D+VWdRkhwXK4pjRNO+bOfa5tZG0RUopxQ4POkZJvGuCKQR8=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357202000_e2024357202059_c2024357202059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'2bbee954-84f9-4f72-bc6b-ab6027879596', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:20:00 (267/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (272/288): 2024-12-22T21:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (272/288): 2024-12-22T21:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8MHKH4CFVTEJ3T', 'x-amz-id-2': '+U05LWIXf5PUfZ6Pf45aoWFGbXZETkE0KIdtuGEBQ0KxNmGr449dhK7EaRcgGQ+SsYkGHK9Uy/IrQUkJ6JS/O/nHWldgAMkI', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357204000_e2024357204059_c2024357204059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:40:00 (269/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'5925cebf-aee6-402c-b167-51917348aed3', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8XQM7HA3ENF3Z0', 'x-amz-id-2': 'iJkGfnn6bk+obL8U4/RZN45MwF4AQwtgWb6YaByJCOBZNRTjOx9QIq3sEJD6qRo9FaH+xXfxFBs=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357203000_e2024357203059_c2024357203059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (273/288): 2024-12-22T21:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (273/288): 2024-12-22T21:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'8f24947f-1bea-4f21-a7bb-1a9c04f1ed9c', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:30:00 (268/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (274/288): 2024-12-22T21:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (274/288): 2024-12-22T21:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8V01WX4RZ7KYQM', 'x-amz-id-2': 'ZsD2X+DFGZSjv1SK4sRShTK/TXyQxVXflRo8u0qHSyy84ZPY7furoU7913sxPF+JodjncD8uGharP9+ajOku+1K+PrAv+UB4D0tfLNCJ6X0=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/20/OR_ABI-L1b-RadC-M6C13_G18_s2024357205000_e2024357205059_c2024357205059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T20:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T20:50:00 (270/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'39a49a80-1599-4bd7-94da-b3c3fee05452', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (275/288): 2024-12-22T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (275/288): 2024-12-22T21:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8YBFMD005T82TZ', 'x-amz-id-2': 'eIBAeYGSQ7g328SB1lhJ4Tv0XmbhVhsu/rWB3BUp9ba3nXRxG0IlpEn2JrV5x9ZmwwNaqxU47OoT5VdGG4xK+biPngyrkeOWuC5j5hZwV/U=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357210000_e2024357210059_c2024357210059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:00:00 (271/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'1fd660f3-baf7-40a7-ace8-cd3d9f00563a', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (276/288): 2024-12-22T21:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (276/288): 2024-12-22T21:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8RDFKD8Z7QNDJ2', 'x-amz-id-2': 'g79Bh9jOdVoq7qrG1QrDpKqfu0bUKgE3jc6MmbXS1wzW01BvbZ6xpMkQ9I10XqTO7djLpxt0WewQydeRc/Y84rOHCt3GeIXT', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357212000_e2024357212059_c2024357212059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:20:00 (273/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'772bf5fa-4a75-47b1-bf35-95a2a1a91b48', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8KXN8F5EP7J242', 'x-amz-id-2': 'xZCkoEYkO8quJ1zZXD7lN24V3Ce7CVgjL4V6xawiGm5gsf8zSR9J4o4sLvg3YNJR0tyeIo+vKjE=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357213000_e2024357213059_c2024357213059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (277/288): 2024-12-22T22:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (277/288): 2024-12-22T22:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0eb21093-bb1c-4aa3-934b-775f5fa03871', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:30:00 (274/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (278/288): 2024-12-22T22:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (278/288): 2024-12-22T22:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8Q94QF6YREWZFA', 'x-amz-id-2': 'rl+BIBi+wXDJOxVtNCS9DbgAZcaleyTSwWuRDvhVJt7RJRCtXjunVwHdgSaMwHssxHnkhCM2JzZpQLARsjvmE3nPl2ZgJ8nFeAsWUIFIQ80=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357211000_e2024357211059_c2024357211059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'de18459d-8d27-4f55-b153-6c7d10b95653', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:10:00 (272/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (279/288): 2024-12-22T22:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (279/288): 2024-12-22T22:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8NXMB913GPAA9B', 'x-amz-id-2': '3ksHjqIQaphBoWv9GplkBG6Uv+X+ip7zwpa/+bdEIgdq9ZwjK5XefEwA1SYmwDLOUNXBZAsbRIYT76lI6QHSKj1IQCHcyfnxjKWGoGc4iro=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357214000_e2024357214059_c2024357214059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'f0341c03-b879-4a1e-8d42-8deef02c84e5', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:40:00 (275/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (280/288): 2024-12-22T22:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (280/288): 2024-12-22T22:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8HMR7AYQ59EA8E', 'x-amz-id-2': 'z2arB8LeTOCs3Zegf7dVwPZpoHTyJZmbf+3H4YNF78ysBZAJmgVC/qVrlqM2lQNLb446vt3uo9CIiV8cN0fmuLya+JypZJRRV+yRFRnwGEA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/21/OR_ABI-L1b-RadC-M6C13_G18_s2024357215000_e2024357215059_c2024357215059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T21:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T21:50:00 (276/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (281/288): 2024-12-22T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (281/288): 2024-12-22T22:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'9635b372-f4a0-4c3e-999b-5373f5f7e000', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8R3YAV0B4YF6N6', 'x-amz-id-2': 'jp0lRHbTTkSxTf/fQ6u3tGGOrZIXeEudsGKmALefkEtCdw5UTvpbcMTMwnFBJgIDRchUqGVJlOhmVvPtl4O0RjbDZ2DdM6Ov', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357220000_e2024357220059_c2024357220059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:00:00 (277/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (282/288): 2024-12-22T22:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (282/288): 2024-12-22T22:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'0631344d-72c9-4a88-bb4e-6461c3fb4d50', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8N6G6N9G3C16VS', 'x-amz-id-2': 'zgt/5/6uixO0T2uf0UMQFq1U2z5k8JDyAtTb2TeATPxDOFSS1erR9lB20sd9+NTfLFzz5AKukAQ=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357221000_e2024357221059_c2024357221059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'19b803e2-db58-4f92-92bf-ac9c3418e549', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:10:00 (278/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (283/288): 2024-12-22T23:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (283/288): 2024-12-22T23:00:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8NPS15NTJJC6J2', 'x-amz-id-2': 'OizTKA7FWHXBdULg06wa3tXV5qtZ3LZDj8LYClofNOfhUWpo+aOm2Fv1x+mZu8mJ+FaN5QXA+ud4NOuit1LVSVRdNKz+pyUP1reLlkwe2UI=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357222000_e2024357222059_c2024357222059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'd0bf6db5-4fc0-4c6c-aa7f-840c8118ed80', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:20:00 (279/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (284/288): 2024-12-22T23:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (284/288): 2024-12-22T23:10:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8H1DYN3HG3STCS', 'x-amz-id-2': 'x1HvtHvbyurSgb19vkjI8jSxlWnQG+X24oGF0z97xIBERiWnOZVWqtqxsTd2zmBVKjp9w9U18A0eQTjuS0GOtoq5cqT51oZ7C0QLPM5+QNw=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357223000_e2024357223059_c2024357223059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:30:00 (280/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'07b4b818-d00e-4afc-8745-39ca740c9a5d', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (285/288): 2024-12-22T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (285/288): 2024-12-22T23:20:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8X5VBZRXD2FVAA', 'x-amz-id-2': 'TiaA9PcwkYKJuY/vTU5BDLUbkA7y7ol8deD2i8ySbdlAI5vyYpBcKvwloip8BGgKX6zuFRP+zYaPEzXtFDJ4mten/Sqp8WvcbHr2QH0k4bU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357224000_e2024357224059_c2024357224059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:40:00 (281/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'bc23e5d5-b706-4aa2-b4db-a4df4633ceb2', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (286/288): 2024-12-22T23:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (286/288): 2024-12-22T23:30:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8J6G9RMRN2Q530', 'x-amz-id-2': 'Ql1Y/jkLXdvI8CtMFeEIKoJ3UWvbagUyphe3R4Scdlid68A7QKtoWAc7yodjjS+Ye61kC5Wr7/wkfZKxCdgfjWFo+jBeFbFE', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/22/OR_ABI-L1b-RadC-M6C13_G18_s2024357225000_e2024357225059_c2024357225059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T22:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T22:50:00 (282/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'db527b8e-71d8-483b-b766-e06d8b8634ef', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (287/288): 2024-12-22T23:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (287/288): 2024-12-22T23:40:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8P25M6G18QKR5S', 'x-amz-id-2': 'NpE2Cq1MK2tC2oWrbM1TuYMCsD+5Ti13tHuLG/o3jxDVUUK1AW1BCiWecf4E6w8vo1stP+iLl+s=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357230000_e2024357230059_c2024357230059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:00:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function sse_md5 at 0x10cb10220>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function validate_bucket_name at 0x10cb10180>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x10cb12340>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <aiobotocore.client.AioClientCreator object at 0x10fbc78c0>>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function generate_idempotent_uuid at 0x10caf3f60>[0m
[36m[D] botocore.hooks: Event before-parameter-build.s3.HeadObject: calling handler <function _handle_request_validation_mode_member at 0x10cb12ac0>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x10cb12520>[0m
[36m[D] botocore.hooks: Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] aiobotocore.regions: Calling endpoint provider with parameters: {'Bucket': 'noaa-goes18', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}[0m
[36m[D] aiobotocore.regions: Endpoint provider result: https://noaa-goes18.s3.amazonaws.com[0m
[36m[D] botocore.regions: Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "<botocore.UNSIGNED object at 0x10c2238c0>"[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_expect_header at 0x10cb10540>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_recursion_detection_header at 0x10caf3b00>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function add_query_compatibility_header at 0x10cb12a20>[0m
[36m[D] botocore.hooks: Event before-call.s3.HeadObject: calling handler <function inject_api_version_header_if_needed at 0x10cb11a80>[0m
[36m[D] botocore.endpoint: Making request for OperationModel(name=HeadObject) with params: {'url_path': '/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc', 'query_string': {}, 'method': 'HEAD', 'headers': {'User-Agent': 'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1'}, 'body': b'', 'auth_path': '/noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc', 'url': 'https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc', 'context': {'client_region': 'us-east-1', 'client_config': <aiobotocore.config.AioConfig object at 0x1250fb0e0>, 'has_streaming_input': False, 'auth_type': 'none', 'unsigned_payload': None, 's3_redirect': {'redirected': False, 'bucket': 'noaa-goes18', 'params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc'}}, 'input_params': {'Bucket': 'noaa-goes18', 'Key': 'ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc'}, 'signing': {}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <bound method AioRequestSigner.handler of <aiobotocore.signers.AioRequestSigner object at 0x1250faf90>>[0m
[36m[D] botocore.hooks: Event choose-signer.s3.HeadObject: calling handler <function set_operation_specific_signer at 0x10caf3d80>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function remove_arn_from_signing_path at 0x10cb12480>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <function _set_extra_headers_for_unsigned_request at 0x10cb12b60>[0m
[36m[D] botocore.hooks: Event before-sign.s3.HeadObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <aiobotocore.utils.AioS3ExpressIdentityResolver object at 0x1251c9400>>[0m
[36m[D] botocore.hooks: Event request-created.s3.HeadObject: calling handler <function add_retry_headers at 0x10cb122a0>[0m
[36m[D] botocore.endpoint: Sending http request: <AWSPreparedRequest stream_output=False, method=HEAD, url=https://noaa-goes18.s3.amazonaws.com/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc, headers={'User-Agent': b'aiobotocore/2.21.1 md/Botocore#1.37.1 ua/2.0 os/macos#24.4.0 md/arch#arm64 lang/python#3.13.3 md/pyimpl#CPython cfg/retry-mode#legacy botocore/1.37.1', 'amz-sdk-invocation-id': b'73c3828c-6b89-4e99-bace-804dcb6dfc39', 'amz-sdk-request': b'attempt=1'}>[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:00:00 (283/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Downloading from S3 (288/288): 2024-12-22T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Downloading from S3 (288/288): 2024-12-22T23:50:00'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Checking S3 for 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Checking S3 for 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8TKHK5XAQ72G2K', 'x-amz-id-2': 'sYkD8Wy29FUIbpNdtmnHumLgbjmVr8WjFyyBVVIMdvajNw1vJTd3jH13IO6Rhax2bEyTgHD0K4Wff1GOKDa80a8RK9aEN9kOiONRvdQ0mwk=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357231000_e2024357231059_c2024357231059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:10:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:10:00 (284/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8M8BB6N163EQ76', 'x-amz-id-2': 'lJ48+cejkKvhDQbGVolzO6XyKhF/SmzDkFwUT0Vmeizpfg+TLXhlaUKN0N0C5mYc8THy2w0008DRn0ZwElWdonpwJRiqsBagLYlUpR5TyVU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357232000_e2024357232059_c2024357232059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:20:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:20:00 (285/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8KRRBRP8G8A8GE', 'x-amz-id-2': 'hWSmIUjvSArJfQ2a1WtaQaBm1td8AiGvEmeVYWCp1w/PtYLh4P43J5wjmgo6x0eDmpGuZBdSV2nDbmiICk3UiaqdL6btRnAdDCjd6sA4wUA=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357233000_e2024357233059_c2024357233059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:30:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:30:00 (286/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8GTW32R34FKTWQ', 'x-amz-id-2': 'FvBTOihOI1WVTwOWwcocFqALn6ZrCt55/ULZRZrrntfpmkH5Mh3MQWiFbh7XDrVnzVbrijq6/pDaIyypetkTlbLXxyZbHgsH', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:30 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357234000_e2024357234059_c2024357234059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:40:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:40:00 (287/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function _handle_200_error at 0x10cb12840>[0m
[36m[D] botocore.hooks: Event before-parse.s3.HeadObject: calling handler <function handle_expires_header at 0x10cb12660>[0m
[36m[D] botocore.parsers: Response headers: {'x-amz-request-id': 'EA8G1YSH3W2BB8V2', 'x-amz-id-2': 'rpAxj9nGlcDE6i9O28YbFGUC+y/4NVJSrXgl6OiX/QxaPz25Jl9AbpNcWH7GeUdnu2rge1u0sdU=', 'content-type': 'application/xml', 'transfer-encoding': 'chunked', 'date': 'Wed, 07 May 2025 01:30:31 GMT', 'server': 'AmazonS3'}[0m
[36m[D] botocore.parsers: Response body:
b''[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <function _update_status_code at 0x10cb12980>[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <aiobotocore.retryhandler.AioRetryHandler object at 0x1251c9160>[0m
[36m[D] botocore.retryhandler: No retry needed.[0m
[36m[D] botocore.hooks: Event needs-retry.s3.HeadObject: calling handler <bound method AioS3RegionRedirectorv2.redirect_from_error of <aiobotocore.utils.AioS3RegionRedirectorv2 object at 0x1251c92b0>>[0m
[36m[D] goesvfi.integrity_check.remote.s3_store: S3 object not found: s3://noaa-goes18/ABI-L1b-RadC/2024/357/23/OR_ABI-L1b-RadC-M6C13_G18_s2024357235000_e2024357235059_c2024357235059.nc[0m
[31m[E] goesvfi.integrity_check.cache_db: Error adding timestamp to cache: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
[31m[E] goesvfi.integrity_check.reconcile_manager: Unexpected error fetching 2024-12-22T23:50:00: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.[0m
Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 355, in add_timestamp
    self.conn.execute("""
    ~~~~~~~~~~~~~~~~~^^^^
        INSERT OR REPLACE INTO timestamps
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        now_iso
        ^^^^^^^
    ))
    ^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/reconcile_manager.py", line 362, in fetch_single
    await self.cache_db.add_timestamp(
    ...<4 lines>...
    )
  File "/Users/justin/Documents/Github/GOES_VFI/goesvfi/integrity_check/cache_db.py", line 373, in add_timestamp
    self.conn.rollback()
    ~~~~~~~~~~~~~~~~~~^^
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 8799325312 and this is thread id 6128873472.
[37m[I] goesvfi.integrity_check.reconcile_manager: Download complete: 0/288 files downloaded successfully[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: File not found on S3: 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> File not found on S3: 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Step 4/4: Unexpected error from S3: 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Formatted as step progress: '<span style='color: #66aaff; font-weight: bold;'>Step 4/4:</span> Unexpected error from S3: 2024-12-22T23:50:00 (288/288)'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status label updated with step formatting[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Download complete: 0/288 files downloaded successfully'[0m
[36m[D] goesvfi.integrity_check.enhanced_gui_tab: Status update received: 'Downloads complete: 0 successful, 288 failed'[0m
[36m[D] __main__: Entering closeEvent...[0m
[37m[I] __main__: Saving application settings...[0m
[36m[D] __main__: MainWindow _save_all_settings - QSettings: org=GOES_VFI, app=GOES_VFI_App, file=/Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist[0m
[36m[D] __main__: Current settings keys before save: ['cropRect', 'inputDir', 'main/lastTabIndex', 'paths/inputDirectory', 'preview/cropRectangle', 'processing/encoder', 'processing/fps', 'processing/maxWorkers', 'processing/multiplier', 'rife/modelKey', 'rife/threadSpec', 'rife/tileSize', 'rife/tilingEnabled', 'rife/ttaSpatial', 'rife/ttaTemporal', 'rife/uhdMode', 'sanchez/falseColorEnabled', 'sanchez/resolutionKm'][0m
[36m[D] goesvfi.gui_tabs.main_tab: MainTab: Saving settings...[0m
[36m[D] goesvfi.gui_tabs.main_tab: QSettings save details: org=GOES_VFI, app=GOES_VFI_App, file=/Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving path settings...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Got input directory from main window: None[0m
[36m[D] goesvfi.gui_tabs.main_tab: No input directory to save (None/empty)[0m
[36m[D] goesvfi.gui_tabs.main_tab: Removing output file setting (None/empty)[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving processing settings...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving FPS: 30[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving multiplier: 2[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving max workers: 5[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving encoder: 'RIFE'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving RIFE options...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving RIFE model key: 'rife-v4.6'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving tiling enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving tile size: 256[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving UHD mode: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving thread spec: '1:2:2'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving TTA spatial: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving TTA temporal: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving Sanchez options...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving false color enabled: False[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving resolution km: '4'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Saving crop rectangle...[0m
[36m[D] goesvfi.gui_tabs.main_tab: Got crop rectangle from main window: None[0m
[36m[D] goesvfi.gui_tabs.main_tab: No crop rectangle to save (None/empty)[0m
[37m[I] goesvfi.gui_tabs.main_tab: MainTab: Settings saved successfully.[0m
[36m[D] goesvfi.gui_tabs.main_tab: Verification - Saved input directory: '/Users/justin/Downloads/abi_rgb_all 18'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Verification - Saved crop rectangle: '702,632,1114,747'[0m
[36m[D] goesvfi.gui_tabs.main_tab: Verification - Settings keys after save: ['cropRect', 'inputDir', 'main/lastTabIndex', 'paths/inputDirectory', 'preview/cropRectangle', 'processing/encoder', 'processing/fps', 'processing/maxWorkers', 'processing/multiplier', 'rife/modelKey', 'rife/threadSpec', 'rife/tileSize', 'rife/tilingEnabled', 'rife/ttaSpatial', 'rife/ttaTemporal', 'rife/uhdMode', 'sanchez/falseColorEnabled', 'sanchez/resolutionKm'][0m
[36m[D] __main__: Main tab settings saved[0m
[36m[D] __main__: Settings file exists after save: /Users/justin/Library/Preferences/com.goes-vfi.GOES_VFI_App.plist (size: 645 bytes)[0m
[36m[D] __main__: Settings keys after save: ['cropRect', 'inputDir', 'main/lastTabIndex', 'paths/inputDirectory', 'preview/cropRectangle', 'processing/encoder', 'processing/fps', 'processing/maxWorkers', 'processing/multiplier', 'rife/modelKey', 'rife/threadSpec', 'rife/tileSize', 'rife/tilingEnabled', 'rife/ttaSpatial', 'rife/ttaTemporal', 'rife/uhdMode', 'sanchez/falseColorEnabled', 'sanchez/resolutionKm'][0m
[36m[D] __main__: Verification - Saved input directory: '/Users/justin/Downloads/abi_rgb_all 18'[0m
[36m[D] __main__: Verification - Saved crop rectangle: '702,632,1114,747'[0m
[37m[I] __main__: All settings saved[0m
[37m[I] __main__: Cleaned up GUI Sanchez temp directory: /var/folders/h2/d10fqbgx4sg3xt10y73ynf_m0000gn/T/goes_vfi_sanchez_gui_39279[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Closing cache database[0m
[36m[D] goesvfi.integrity_check.enhanced_view_model: Closing reconciler[0m
[37m[I] goesvfi.integrity_check.enhanced_view_model: Cleanup completed (with 0 active tasks still running)[0m
[37m[I] __main__: Cleaned up integrity check resources[0m
